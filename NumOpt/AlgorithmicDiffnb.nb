(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     88443,       2290]
NotebookOptionsPosition[     81790,       2191]
NotebookOutlinePosition[     82313,       2210]
CellTagsIndexPosition[     82270,       2207]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Algorithmic Differentiation", "Title",
 CellChangeTimes->{{3.9398152070839567`*^9, 3.9398152117860727`*^9}, {
  3.9421541444318066`*^9, 3.9421541513390083`*^9}, {3.944393994649187*^9, 
  3.9443940027240753`*^9}, {3.9443979907577295`*^9, 3.944397995195145*^9}, {
  3.9454196831749916`*^9, 
  3.9454196934074483`*^9}},ExpressionUUID->"8e791b87-b8fe-4d47-a58b-\
235908e2ee0d"],

Cell["\<\
We need first and second derivatives for our tests and algorithms.  In the \
real world our constraints and cost function are defined by computer code. \
Algorithmic Differentiation (AD) provides ways to generate code for \
derivatives from the code for the functions.  It used to be called Automatic \
Differentiation but the folks that do it thought that gave the wrong \
impression and just decided to change their name but not their acronym! \
\>", "Text",
 CellChangeTimes->{{3.945419713648871*^9, 
  3.9454199185364113`*^9}},ExpressionUUID->"52d2d1c4-50f1-4cf8-95db-\
0b4fd6379271"],

Cell["First a reminder of what we know. ", "Text",
 CellChangeTimes->{{3.945419713648871*^9, 
  3.945419927295216*^9}},ExpressionUUID->"333077d3-2330-4a50-a57d-\
0125f81e3a91"],

Cell[CellGroupData[{

Cell["Derivatives and Finite Differences", "Section",
 CellChangeTimes->{{3.944394028275735*^9, 3.9443940429804287`*^9}, {
  3.9443980015900307`*^9, 3.944398004381872*^9}, {3.944398204053638*^9, 
  3.9443982098374424`*^9}, {3.9444832170626287`*^9, 
  3.944483225811733*^9}},ExpressionUUID->"166232e8-0c31-4027-9160-\
5de5902d8361"],

Cell[TextData[{
 "For ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", "\[DoubleStruckCapitalR]"}], "\[Rule]", 
    "\[DoubleStruckCapitalR]"}], TraditionalForm]],ExpressionUUID->
  "076d8df4-10a7-4428-95b7-8fa4f3059f4f"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "\[Element]", "\[DoubleStruckCapitalR]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f65f7b30-23c8-4b8f-8df6-4cb3b94ae695"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"f", "'"}], "[", "x", "]"}], "=", 
    RowBox[{
     SubscriptBox["lim", 
      RowBox[{"h", "->", "0"}]], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", "h"}], "]"}], "-", 
       RowBox[{"f", "[", "x", "]"}]}], "h"]}]}], TraditionalForm]],
  ExpressionUUID->"19fe4355-7de9-44f4-94a8-7cfd3b1303f6"]
}], "Text",
 CellChangeTimes->{{3.9421541554354906`*^9, 3.9421542324986663`*^9}, {
   3.942154333286024*^9, 3.942154357739272*^9}, {3.9443940492901783`*^9, 
   3.944394184883862*^9}, 3.9443942206646233`*^9, {3.944398012812304*^9, 
   3.944398195366064*^9}, {3.94439823454744*^9, 3.94439834546235*^9}, {
   3.9444832419222283`*^9, 
   3.9444836444372826`*^9}},ExpressionUUID->"8dc7ee3e-9778-4aba-9550-\
4dcf93414ed8"],

Cell[TextData[{
 "For ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], "\[Rule]", 
    "\[DoubleStruckCapitalR]"}], TraditionalForm]],ExpressionUUID->
  "64d931cf-0211-42ac-95db-a8c7935dae42"],
 " and and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", ",", 
    RowBox[{"u", "\[Element]", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bbf8ed6f-9a94-45c5-837b-6099a324ce9d"],
 "\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      RowBox[{
       SubscriptBox["\[PartialD]", "u"], "f"}], "=", 
      RowBox[{
       SubscriptBox["lim", 
        RowBox[{"h", "->", "0"}]], 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x", "+", " ", 
           RowBox[{"h", " ", "u"}]}], " ", "]"}], "-", 
         RowBox[{"f", "[", "x", "]"}]}], "h"]}]},
     {
      FractionBox[
       RowBox[{"\[PartialD]", "f"}], 
       RowBox[{"\[PartialD]", 
        SubscriptBox["x", "i"]}]], "=", 
      RowBox[{
       SubscriptBox["lim", 
        RowBox[{"h", "->", "0"}]], 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x", "+", " ", 
           RowBox[{"h", " ", 
            SubscriptBox["e", "i"]}]}], " ", "]"}], "-", 
         RowBox[{"f", "[", "x", "]"}]}], "h"]}]},
     {"Df", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "1"], "f"}], ",", 
        RowBox[{
         SubscriptBox["\[PartialD]", "2"], "f"}], ",", "\[Ellipsis]", ",", 
        RowBox[{
         SubscriptBox["\[PartialD]", "n"], "f"}]}], "}"}]}
    }], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "05dc452a-0e4f-4c9c-990a-4ce538f0bca1"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "i"], "f"}], "=", 
    RowBox[{
     RowBox[{"\[PartialD]", "f"}], "/", 
     RowBox[{"\[PartialD]", 
      SubscriptBox["x", "i"]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "84dc4874-403b-437b-805b-208f4c3c2d94"],
 " and we have skipped writing down the x dependence.  "
}], "Text",
 CellChangeTimes->{{3.9421541554354906`*^9, 3.9421542324986663`*^9}, {
   3.942154333286024*^9, 3.942154357739272*^9}, {3.9443940492901783`*^9, 
   3.944394184883862*^9}, 3.9443942206646233`*^9, {3.944398012812304*^9, 
   3.944398195366064*^9}, {3.94439823454744*^9, 3.94439834546235*^9}, {
   3.9444832419222283`*^9, 3.944483632148913*^9}, {3.944483991110963*^9, 
   3.944483991110963*^9}},ExpressionUUID->"57cf2e6f-1098-42db-8dd3-\
1e1c7ce79211"],

Cell[TextData[{
 "A derivative of a derivative is a second derivative.  The Hessian of  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], "\[Rule]", 
    "\[DoubleStruckCapitalR]"}], TraditionalForm]],ExpressionUUID->
  "5f4806fd-03e8-4465-8497-027224664530"],
 " \nis the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "fc9baec5-9cd3-449b-9f88-61d4f857e56e"],
 " symmetric matrix of second derivatives\n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      FractionBox[
       RowBox[{"\[PartialD]", "f"}], 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SubscriptBox["x", "i"]}], 
        RowBox[{"\[PartialD]", 
         SubscriptBox["x", "j"]}]}]], "=", 
      RowBox[{
       SubscriptBox["\[PartialD]", "i"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[PartialD]", "j"], "f"}], ")"}]}], "=", 
      RowBox[{
       SubscriptBox["\[PartialD]", "j"], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[PartialD]", "i"], "f"}], ")"}]}]},
     {
      SubscriptBox["DDf", 
       RowBox[{"i", ",", "j"}]], "=", 
      SubscriptBox["H", 
       RowBox[{"i", ",", "j"}]], "=", 
      RowBox[{
       SubscriptBox["\[PartialD]", "ij"], "f"}]}
    }], TraditionalForm]],ExpressionUUID->
  "f97587b7-5d73-40e9-ba2f-92e7797a3334"],
 "  \nCalculus courses usually cover finite Difference(FD) approximations\n\n",
 Cell[BoxData[GridBox[{
    {" ", 
     RowBox[{"Forward", " ", "Diff"}], 
     RowBox[{"Centered", " ", "Diff"}]},
    {
     RowBox[{
      RowBox[{"f", "'"}], "[", "x", "]"}], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", "h"}], "]"}], "-", 
       RowBox[{"f", "[", "x", "]"}]}], "h"], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", "h"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"x", "-", "h"}], "]"}]}], 
      RowBox[{"2", "h"}]]},
    {
     RowBox[{
      RowBox[{"f", "''"}], "[", "x", "]"}], 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"x", "+", 
          RowBox[{"2", "h"}]}], "]"}], "-", 
        RowBox[{"2", 
         RowBox[{"f", "[", 
          RowBox[{"x", "+", "h"}], "]"}]}], "+", 
        RowBox[{"f", "[", "x", "]"}]}], 
       SuperscriptBox["h", "2"]], " "}], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", "h"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"f", "[", "x", "]"}]}], "+", 
       RowBox[{"f", "[", 
        RowBox[{"x", "-", "h"}], "]"}]}], 
      SuperscriptBox["h", "2"]]},
    {
     RowBox[{
      SubscriptBox["\[PartialD]", "i"], 
      RowBox[{"f", "[", "x", "]"}]}], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "i"]}], "]"}], "-", 
       RowBox[{"f", "[", "x", "]"}]}], "h"], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "i"]}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"x", "-", 
         SubscriptBox["he", "i"]}], "]"}]}], 
      RowBox[{"2", "h"}]]},
    {
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"i", ",", "j"}]], 
      RowBox[{"f", "[", "x", "]"}]}], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "i"], "+", " ", 
         SubscriptBox["he", "j"]}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "i"]}], "]"}], "-", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "j"]}], "]"}], "+", " ", 
       RowBox[{"f", "[", "x", "]"}]}], 
      SuperscriptBox["h", "2"]], 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "i"], "+", " ", 
         SubscriptBox["he", "j"]}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "i"], "-", 
         SubscriptBox["he", "j"]}], "]"}], "-", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x", "+", 
         SubscriptBox["he", "j"], "-", 
         SubscriptBox["he", "i"]}], "]"}], "+", " ", 
       RowBox[{"f", "[", 
        RowBox[{"x", "-", 
         SubscriptBox["he", "i"], "-", 
         SubscriptBox["he", "j"]}], "]"}]}], 
      SuperscriptBox["h", "2"]]}
   },
   GridBoxDividers->{"Columns" -> {{True}}, "Rows" -> {{True}}}]],
  ExpressionUUID->"220f5870-7307-499e-875b-2b680afdf159"]
}], "Text",
 CellChangeTimes->{{3.9421541554354906`*^9, 3.9421542324986663`*^9}, {
   3.942154333286024*^9, 3.942154357739272*^9}, {3.9443940492901783`*^9, 
   3.944394184883862*^9}, 3.9443942206646233`*^9, {3.944398012812304*^9, 
   3.944398195366064*^9}, {3.94439823454744*^9, 3.94439834546235*^9}, {
   3.9444832419222283`*^9, 3.94448416773903*^9}, {3.94448531344413*^9, 
   3.9444853879242268`*^9}},ExpressionUUID->"b5b26ad2-76ac-4041-9cdc-\
3e684ff7e981"],

Cell["\<\
Taylor Series (TS) show that centered differences are more accurate with \
error behavior described by the TS error terms. \
\>", "Text",
 CellChangeTimes->{{3.944485401565301*^9, 3.944485496884471*^9}, {
  3.9444861691808224`*^9, 
  3.944486267708539*^9}},ExpressionUUID->"4b5dd14f-980f-403c-bb7b-\
281cfc75fd14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Cos", "[", 
   RowBox[{"x", " ", "+", " ", 
    RowBox[{"Exp", "[", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "+", 
        SuperscriptBox["x", "2"]}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", "1.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LogLogPlot", ",", 
    RowBox[{"GridLines", "->", "Automatic"}], ",", 
    RowBox[{"MaxRecursion", "->", "4"}], ",", 
    RowBox[{"Frame", "->", "True"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"h", ",", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "'"}], "[", "x", "]"}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x", "+", "h"}], "]"}], "-", 
         RowBox[{"f", "[", "x", "]"}]}], "h"]}], "]"}], ",", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "''"}], "[", "x", "]"}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x", "+", 
           RowBox[{"2", "h"}]}], "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"f", "[", 
           RowBox[{"x", "+", "h"}], "]"}]}], "+", 
         RowBox[{"f", "[", "x", "]"}]}], 
        SuperscriptBox["h", "2"]]}], "]"}], ",", "\[IndentingNewLine]", 
     SuperscriptBox["h", "2"], ",", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "'"}], "[", "x", "]"}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x", "+", "h"}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"x", "-", "h"}], "]"}]}], 
        RowBox[{"2", "h"}]]}], "]"}], ",", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "''"}], "[", "x", "]"}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x", "+", "h"}], "]"}], "-", 
         RowBox[{"2", 
          RowBox[{"f", "[", "x", "]"}]}], "+", 
         RowBox[{"f", "[", 
          RowBox[{"x", "-", "h"}], "]"}]}], 
        SuperscriptBox["h", "2"]]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "9"}]], ",", " ", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<h\>\"", ",", "\"\<err\>\""}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<O(h)\>\"", ",", "\"\<\!\(\*SubscriptBox[\(FD\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(FD\), \(2\)]\)\>\"", ",", 
      "\"\<O(\!\(\*SuperscriptBox[\(h\), \(2\)]\))\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(CD\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(CD\), \(2\)]\)\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9444855017582016`*^9, 3.9444859755491095`*^9}, {
   3.9444860055912704`*^9, 3.9444861317821198`*^9}, 3.944486403253873*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"8d413ed4-3246-4e9f-93f1-296a522ed9a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Algorithmic Differentiation", "Section",
 CellChangeTimes->{{3.945258545322403*^9, 
  3.9452585532231183`*^9}},ExpressionUUID->"2a35e951-2dc0-473d-a920-\
8b69810e70d7"],

Cell[TextData[{
 "Every single piece of a computer function is either arithmetic, logic, or a \
call to a special function that we  know the derivative of.  Each of those \
pieces (except the logic) is differentiable. So we can go line by line and \
differentiate.  At the bottom level this is all AD is.  There are two common \
ways to accumulate the derivatives.  Forward or Backward in the flow of the \
program.  Forward is easy to understand and code. Backwards is theoretically \
more efficient at computing the gradient of a function ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], "\[Rule]", 
    "\[DoubleStruckCapitalR]"}], TraditionalForm]],ExpressionUUID->
  "a80b3c69-aae8-4bc8-9258-fab68ab9d110"],
 "."
}], "Text",
 CellChangeTimes->{{3.9454199371876965`*^9, 3.945420180443042*^9}, {
  3.9463026508359394`*^9, 
  3.9463026512831144`*^9}},ExpressionUUID->"290e7fd3-fd3f-4d5a-848d-\
ec08f4a63f9b"],

Cell[CellGroupData[{

Cell["Basic Example: Forward Mode", "Subsection",
 CellChangeTimes->{{3.9443952047499743`*^9, 3.944395213314677*^9}, {
  3.9443967397979164`*^9, 3.944396740587636*^9}, {3.945420391866824*^9, 
  3.945420395415386*^9}},ExpressionUUID->"91b136c6-116b-4d23-bc27-\
00d942db8794"],

Cell[TextData[{
 "This is much clearer with an example. The function from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "3"]}], "\[Rule]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "542d6ee8-bc54-4a0d-9679-f656f680773b"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "[", "x", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "3"], "+", 
       RowBox[{
        SubscriptBox["x", "1"], 
        SubscriptBox["x", "2"]}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "1"], 
        SubscriptBox["x", "2"]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["x", "1"], "+", 
         RowBox[{"Sin", "[", 
          SubscriptBox["x", "3"], "]"}]}], "]"}]}]}], "}"}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d74df230-85da-494c-a4f4-e6f03b13cf90"],
 "\nis easy to implement.  Here is code to compute it in small steps with the \
work variables stored in a sequence of \[OpenCurlyDoubleQuote]work\
\[CloseCurlyDoubleQuote] variables."
}], "Text",
 CellChangeTimes->{{3.9421541554354906`*^9, 3.9421542324986663`*^9}, {
  3.942154333286024*^9, 3.942154357739272*^9}, {3.9443940492901783`*^9, 
  3.944394184883862*^9}, {3.944394222892753*^9, 3.9443943992058945`*^9}, {
  3.944396749586152*^9, 3.9443968829222665`*^9}, {3.944396918902433*^9, 
  3.944396918902433*^9}, {3.9443970455662546`*^9, 
  3.9443971163269677`*^9}},ExpressionUUID->"5abd1488-9fad-4274-ba48-\
14a0ca25ad96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"w1", "=", 
      RowBox[{"x1", "*", "x2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w2", "=", 
      RowBox[{"x3", "+", "w1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w3", "=", 
      RowBox[{"Sin", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w4", "=", 
      RowBox[{"x1", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w5", "=", 
      RowBox[{"Cos", "[", "w4", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"w2", ",", "w5"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9443944007735624`*^9, 3.9443944965230265`*^9}, {
  3.9443946263083897`*^9, 3.944394674524691*^9}, {3.9443948042845483`*^9, 
  3.9443948045656834`*^9}, {3.944394981300975*^9, 3.944394988748415*^9}, {
  3.9443968856059637`*^9, 3.9443970429327793`*^9}, {3.9458701690189576`*^9, 
  3.945870169132577*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"6baa5eb3-7d5b-4725-a5ac-76bd9ea3ef3b"],

Cell["\<\
Functions always need to be tested.  This is far from a complete test! \
\>", "Text",
 CellChangeTimes->{{3.9443947345638638`*^9, 3.9443947526118803`*^9}, {
  3.9443975001791945`*^9, 
  3.94439750379774*^9}},ExpressionUUID->"a2c59d8a-df8f-4412-a2ee-\
1eca8599d1b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "1.4", ",", "0.6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", "x", "]"}]}], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
  3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
  3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
  3.944397676777595*^9, 3.944397698376417*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"23c1acd6-16d4-4949-8c73-54b706ae3108"],

Cell["\<\
Here is a forward mode Algorithmic Differentiation (AD) code for the \
function. \
\>", "Text",
 CellChangeTimes->{{3.944394540049657*^9, 3.944394585020705*^9}, {
  3.944397177532831*^9, 3.9443971780508604`*^9}, {3.944397829764095*^9, 
  3.9443978313808312`*^9}},ExpressionUUID->"7c8b097e-1521-4875-897d-\
4dd95886bb47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"df", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dx1_", ",", "dx2_", ",", "dx3_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5", ",", "dw1", ",", "dw2",
       ",", "dw3", ",", "dw4", ",", "dw5"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dw1", "=", 
      RowBox[{
       RowBox[{"dx1", "*", "x2"}], "+", 
       RowBox[{"x1", "*", "dx2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w1", "=", 
      RowBox[{"x1", "*", "x2"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dw2", "=", 
      RowBox[{"dx3", "+", "dw1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w2", "=", 
      RowBox[{"x3", "+", "w1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dw3", "=", 
      RowBox[{
       RowBox[{"Cos", "[", "x3", "]"}], "*", "dx3"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w3", "=", 
      RowBox[{"Sin", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dw4", "=", 
      RowBox[{"dx1", "+", "dw3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w4", "=", 
      RowBox[{"x1", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dw5", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "w4", "]"}]}], "*", "dw4"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w5", "=", 
      RowBox[{"Cos", "[", "w4", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w2", ",", "w5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dw2", ",", "dw5"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9443944007735624`*^9, 3.9443944965230265`*^9}, {
  3.944394594933754*^9, 3.944394600058935*^9}, {3.9443947930284047`*^9, 
  3.944394945212783*^9}, {3.944394997474428*^9, 3.944395016957123*^9}, {
  3.9443954548310676`*^9, 3.9443954604371734`*^9}, {3.944397187184567*^9, 
  3.944397348678116*^9}, {3.9463027135590086`*^9, 3.946302726171547*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"399f7849-9931-43d7-8e37-ecb2d93b4685"],

Cell["We need to test this trick. ", "Text",
 CellChangeTimes->{{3.9443951645385656`*^9, 
  3.9443951938215485`*^9}},ExpressionUUID->"5845354c-c66c-45da-a246-\
489ae1ddc581"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", 
     RowBox[{"-", "0.4"}], ",", 
     RowBox[{"-", "0.6"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{"{", 
    RowBox[{"1.2", ",", 
     RowBox[{"-", "3.6"}], ",", 
     RowBox[{"-", "3.4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f1", ",", "f2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"df1", ",", "df2"}], "}"}]}], "}"}], "=", 
  RowBox[{"df", "[", 
   RowBox[{"x", ",", "dx"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", "+", " ", 
        RowBox[{"h", " ", "dx"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", "+", " ", 
        RowBox[{"h", " ", "dx"}]}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"f1", "+", 
      RowBox[{"h", " ", "df1"}]}], ",", 
     RowBox[{"f2", "+", 
      RowBox[{"h", " ", "df2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"h", ",", " ", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(f\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(f\), \(2\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(t\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(t\), \(2\)]\)\>\""}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
  3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
  3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
  3.94439753632368*^9, 3.9443976489404154`*^9}, {3.944397708899124*^9, 
  3.94439780474932*^9}, {3.9458639055555763`*^9, 3.9458639262306943`*^9}, {
  3.9458711768383083`*^9, 3.94587117720055*^9}, {3.945871295316576*^9, 
  3.9458713069038963`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"dd0e6c09-53e5-484c-98f9-bb69ae2457b7"],

Cell["\<\
They look like tangent lines to me.   The AD code produces accurate \
derivatives!\
\>", "Text",
 CellChangeTimes->{{3.945865052969289*^9, 
  3.94586511059755*^9}},ExpressionUUID->"d13fbf2c-9e02-45fd-b847-\
1371eb117fc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x0", ",", "dx0"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gradf", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Df0", "=", 
  RowBox[{
   RowBox[{"Gradf", "[", "x0", "]"}], ".", "dx0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"f0", ",", "df0"}], "}"}], "=", 
  RowBox[{"df", "[", 
   RowBox[{"x0", ",", "dx0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Df0", "-", "df0"}]}], "Input",
 CellChangeTimes->{{3.944395028688639*^9, 3.944395154182686*^9}, {
  3.944395903754631*^9, 3.944396020677758*^9}, {3.9458642676315775`*^9, 
  3.9458642922948084`*^9}, {3.945864502478201*^9, 3.945864808704899*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"a1aafdcf-069e-48bc-83ff-e6ce8f52924e"],

Cell["\<\
The centered difference produces reasonably accurate derivatives IF we use a \
good value for \[OpenCurlyDoubleQuote]h\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.9458651142227182`*^9, 
  3.945865175445055*^9}},ExpressionUUID->"8de9194d-0400-4df6-a2ac-\
99e08f043e72"],

Cell[BoxData[
 RowBox[{"LogLogPlot", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"h", ",", 
     SuperscriptBox["h", "2"], ",", "\[IndentingNewLine]", 
     RowBox[{"Norm", "[", 
      RowBox[{"Df0", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x0", "+", 
           RowBox[{"h", " ", "dx0"}]}], "]"}], "-", 
         RowBox[{"f", "[", "x0", "]"}]}], "h"]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Norm", "[", 
      RowBox[{"Df0", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x0", "+", 
           RowBox[{"h", " ", "dx0"}]}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{"x0", "-", 
           RowBox[{"h", " ", "dx0"}]}], "]"}]}], 
        RowBox[{"2", "h"}]]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", ",", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "12"}]], ",", " ", "1"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"GridLines", "->", "Automatic"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<h\>\"", ",", "\"\<err\>\""}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<O(h)\>\"", ",", "\"\<O(\!\(\*SuperscriptBox[\(h\), \(2\)]\))\>\"", 
      ",", "\"\<\!\(\*SubscriptBox[\(FD\), \(err\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(CD\), \(err\)]\)\>\""}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"MaxRecursion", "->", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.944395028688639*^9, 3.944395154182686*^9}, {
   3.944395903754631*^9, 3.944396020677758*^9}, {3.9458642676315775`*^9, 
   3.9458642922948084`*^9}, {3.945864502478201*^9, 3.9458647863243604`*^9}, 
   3.945864834478871*^9, {3.945864883867593*^9, 3.9458649852875595`*^9}, {
   3.9458651833186827`*^9, 3.9458652189915934`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"1a651c6e-6de4-40e6-a58f-35c8ac0fccea"],

Cell["\<\
You can do the same thing again to get a directional second derivative as \
well.  \
\>", "Text",
 CellChangeTimes->{{3.9443952715892515`*^9, 3.94439530538078*^9}, 
   3.945865021684554*^9, {3.945865256375909*^9, 3.9458652729824967`*^9}, 
   3.946032427308095*^9, 3.946302806417033*^9, {3.9463030514915166`*^9, 
   3.946303054492008*^9}},ExpressionUUID->"9c2358fd-ea4d-438f-b41f-\
3b01ea512ea7"],

Cell[TextData[{
 "I am going to illustrate the second derivative on the generalized \
Rosenbrock function \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], "\[Rule]", 
    "\[DoubleStruckCapitalR]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e56ffa65-7479-4288-8f29-d91e0d364a74"],
 ".\nhttps://en.wikipedia.org/wiki/Rosenbrock_function.\nHere is an AD \
implementation of the Rosenbrock function computing two directional first \
derivatives simultaneously. "
}], "Text",
 CellChangeTimes->{{3.946302815644961*^9, 3.9463028702841053`*^9}, {
  3.9463029155394497`*^9, 3.9463029285076637`*^9}, {3.946302967945716*^9, 
  3.9463029684823403`*^9}, {3.946303058403187*^9, 3.9463030759249105`*^9}, {
  3.9463033998686814`*^9, 3.946303438403245*^9}, {3.9463043224018106`*^9, 
  3.946304323379318*^9}},ExpressionUUID->"b7e4eba0-7796-4905-b686-\
ca49be55365d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Rosen", "[", "x_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "x", "]"}]}], ",", 
       RowBox[{"eta", "=", "100.0"}], ",", 
       RowBox[{"sum", "=", "0.0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"sum", "+=", 
         RowBox[{
          RowBox[{"eta", "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              SuperscriptBox[
               RowBox[{
               "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "2"]}], ")"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "2"]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "sum"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dRosen", "[", 
   RowBox[{"x_", ",", "dx1_", ",", "dx2_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ",", 
      RowBox[{"eta", "=", "100.0"}], ",", 
      RowBox[{"sum", "=", "0.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Added", " ", "Accumulators", " ", "for", " ", "1", "st", " ", 
        "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dsum1", "=", "0.0"}], ",", 
      RowBox[{"dsum2", "=", "0.0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "derivatives", " ", "in", " ", "the", " ", "dx1", " ", "and", " ", 
        "dx2", " ", "directions"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dsum1", "+=", 
         RowBox[{
          RowBox[{"2.0", "*", "eta", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             SuperscriptBox[
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx1", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"2.0", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{
              "dx1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], ")"}]}], "-", 
          RowBox[{"2.0", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "*", 
           RowBox[{
           "dx1", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dsum2", "+=", 
         RowBox[{
          RowBox[{"2.0", "*", "eta", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             SuperscriptBox[
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx2", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"2.0", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{
              "dx2", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], ")"}]}], "-", 
          RowBox[{"2.0", "*", 
           RowBox[{"(", 
            RowBox[{"1.0", "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "*", 
           RowBox[{
           "dx2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Original", " ", "Code"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sum", "+=", 
         RowBox[{
          RowBox[{"eta", "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              SuperscriptBox[
               RowBox[{
               "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "2"]}], ")"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "2"]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"sum", ",", 
       RowBox[{"{", 
        RowBox[{"dsum1", ",", "dsum2"}], "}"}]}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9463028721878843`*^9, 3.946302902554698*^9}, {
  3.946302978134822*^9, 3.9463029816935153`*^9}, {3.9463031038821836`*^9, 
  3.9463033951799984`*^9}, {3.946303520186606*^9, 3.9463035827558994`*^9}, {
  3.9463041419992085`*^9, 3.946304146013278*^9}, {3.946304210545718*^9, 
  3.946304266403878*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"cce023f8-8b9b-45f8-9022-801be4d573c5"],

Cell["Here is a test.", "Text",
 CellChangeTimes->{{3.9443952715892515`*^9, 3.94439530538078*^9}, 
   3.945865021684554*^9, {3.945865256375909*^9, 3.9458652729824967`*^9}, 
   3.946032427308095*^9, {3.9463034499699287`*^9, 
   3.946303454005636*^9}},ExpressionUUID->"b73adf86-3e3f-4b69-a89f-\
7f31ff34d6e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x0", ",", "dx1", ",", "dx2"}], "}"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f0", ",", 
     RowBox[{"{", 
      RowBox[{"df1", ",", "df2"}], "}"}]}], "}"}], "=", 
   RowBox[{"dRosen", "[", 
    RowBox[{"x0", ",", "dx1", ",", "dx2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TabView", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<\|01f441\:fe0f\>\"", "->", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Rosen", "[", 
           RowBox[{"x0", "+", 
            RowBox[{"h", " ", "dx1"}]}], "]"}], ",", 
          RowBox[{"Rosen", "[", 
           RowBox[{"x0", "+", 
            RowBox[{"h", " ", "dx2"}]}], "]"}], ",", 
          RowBox[{"f0", "+", 
           RowBox[{"h", " ", "df1"}]}], ",", 
          RowBox[{"f0", "+", 
           RowBox[{"h", " ", "df2"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", " ", 
          RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<err\>\"", "->", 
      RowBox[{"LogLogPlot", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          SuperscriptBox["h", "2"], ",", "\[IndentingNewLine]", 
          RowBox[{"Abs", "[", 
           RowBox[{"f0", "+", 
            RowBox[{"h", " ", "df1"}], "-", 
            RowBox[{"Rosen", "[", 
             RowBox[{"x0", "+", 
              RowBox[{"h", " ", "dx1"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Abs", "[", 
           RowBox[{"f0", "+", 
            RowBox[{"h", " ", "df2"}], "-", 
            RowBox[{"Rosen", "[", 
             RowBox[{"x0", "+", 
              RowBox[{"h", " ", "dx2"}]}], "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", " ", 
          SuperscriptBox["10", 
           RowBox[{"-", "11"}]], ",", "0.5"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", 
          RowBox[{
          "\"\<O(\!\(\*SuperscriptBox[\(h\), \(2\)]\))\>\"", ",", "\"\<1\>\"",
            ",", "\"\<2\>\""}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "}"}], ",", "2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9463034558299007`*^9, 3.9463035055866756`*^9}, {
  3.946303590090513*^9, 3.946303846167071*^9}, {3.946303931197199*^9, 
  3.9463040479337006`*^9}, {3.9463040789349384`*^9, 3.946304079666282*^9}, {
  3.9463041818433404`*^9, 3.946304182059063*^9}, {3.9463042816069484`*^9, 
  3.9463042819235344`*^9}, {3.9463043406388564`*^9, 3.9463043993770123`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"ae17cf82-17bc-41d0-a01c-5495e9284ddf"],

Cell["\<\
Here is code computing the gradient \[OpenCurlyDoubleQuote]automatically\
\[CloseCurlyDoubleQuote] in Mathematica.\
\>", "Text",
 CellChangeTimes->{{3.946304426609235*^9, 3.9463044462986774`*^9}, {
  3.9463049896029186`*^9, 
  3.9463050025060897`*^9}},ExpressionUUID->"cff8976e-9eec-4f14-9816-\
c3430ad33f12"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "x", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradR", "[", "x_", "]"}], "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Rosen", "[", "vars", "]"}], ",", 
       RowBox[{"{", "vars", "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":>", 
      RowBox[{
      "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9463047827699614`*^9, 3.946304969137699*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"26979316-a672-4c2d-bf57-19747bdbd899"],

Cell["\<\
Here is AD code computing the mixed derivative at the same time as the two \
directional derivatives. \
\>", "Text",
 CellChangeTimes->{{3.946304426609235*^9, 3.9463044462986774`*^9}, {
  3.946305007551837*^9, 
  3.9463050188561153`*^9}},ExpressionUUID->"55d62b98-938e-4836-aee7-\
a26859274e0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ddRosen", "[", 
   RowBox[{"x_", ",", "dx1_", ",", "dx2_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ",", 
      RowBox[{"eta", "=", "100.0"}], ",", 
      RowBox[{"sum", "=", "0.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Added", " ", "Accumulators", " ", "for", " ", "1", "st", " ", 
        "derivatives"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dsum1", "=", "0.0"}], ",", 
      RowBox[{"dsum2", "=", "0.0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Added", " ", "Accumulators", " ", "Mixed", " ", "Second", " ", 
        "derivative"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ddsum12", "=", "0.0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Mixed", " ", "second", " ", "derivative"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ddsum12", "+=", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"2.0", "*", "eta", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx2", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"2", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              RowBox[{
              "dx2", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx1", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"2.0", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{
              "dx1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], ")"}]}], "+", 
          "\[IndentingNewLine]", 
          RowBox[{"2.0", "*", "eta", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             SuperscriptBox[
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"0.0", "-", 
             RowBox[{"2.0", 
              RowBox[{
              "dx2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{
              "dx1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
          "-", 
          RowBox[{"2.0", "*", 
           RowBox[{"(", 
            RowBox[{"0.0", "-", 
             RowBox[{
             "dx2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "*", 
           RowBox[{
           "dx1", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "derivatives", " ", "in", " ", "the", " ", "dx1", " ", "and", " ", 
          "dx2", " ", "directions"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dsum1", "+=", 
         RowBox[{
          RowBox[{"2.0", "*", "eta", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             SuperscriptBox[
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx1", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"2.0", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{
              "dx1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], ")"}]}], "-", 
          RowBox[{"2.0", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "*", 
           RowBox[{
           "dx1", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dsum2", "+=", 
         RowBox[{
          RowBox[{"2.0", "*", "eta", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             SuperscriptBox[
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "2"]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx2", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"2.0", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "*", 
              RowBox[{
              "dx2", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], ")"}]}], "-", 
          RowBox[{"2.0", "*", 
           RowBox[{"(", 
            RowBox[{"1.0", "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "*", 
           RowBox[{
           "dx2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Original", " ", "Code"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sum", "+=", 
         RowBox[{
          RowBox[{"eta", "*", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
              SuperscriptBox[
               RowBox[{
               "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "2"]}], ")"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ")"}], "2"]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"sum", ",", 
       RowBox[{"{", 
        RowBox[{"dsum1", ",", "dsum2"}], "}"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.946304450345966*^9, 3.9463045196845617`*^9}, {
  3.9463045689935355`*^9, 3.946304649282771*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"2ae07f1b-31eb-4eca-b257-83d36c466912"],

Cell["Here is a test. ", "Text",
 CellChangeTimes->{{3.9463046788081465`*^9, 3.9463046831038375`*^9}, {
  3.946304754311858*^9, 
  3.9463047550575905`*^9}},ExpressionUUID->"810609ac-e1cf-4d54-a628-\
b0677d953706"],

Cell[BoxData[
 RowBox[{"Plot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dRosen", "[", 
    RowBox[{
     RowBox[{"x0", "+", 
      RowBox[{"h", " ", "dx1"}]}], ",", "dx1", ",", "dx2"}], "]"}], 
   "\[LeftDoubleBracket]", 
   RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.9463047431483994`*^9, 
  3.9463047664654922`*^9}},ExpressionUUID->"a1e8fc20-924b-45d4-b7af-\
89b192fb20ef"],

Cell[BoxData[
 RowBox[{"Plot", "[", " ", 
  RowBox[{"dRosen", "[", 
   RowBox[{"x0", ",", "dx1", ",", "dx2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.946304688643429*^9, 
  3.946304711737569*^9}},ExpressionUUID->"f9ac4212-fa33-474d-a293-\
62e2f0649f46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ddf", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dx1_", ",", "dx2_", ",", "dx3_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"dy1_", ",", "dy2_", ",", "dy3_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5", ",", 
      "\[IndentingNewLine]", "dw1", ",", "dw2", ",", "dw3", ",", "dw4", ",", 
      "dw5", ",", "\[IndentingNewLine]", "ddw1", ",", "ddw2", ",", "ddw3", 
      ",", "ddw4", ",", "ddw5"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ddw1", "=", 
      RowBox[{
       RowBox[{"dx1", "*", "dy2"}], "+", 
       RowBox[{"dy1", "*", "dx2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw1", "=", 
      RowBox[{
       RowBox[{"dx1", "*", "x2"}], "+", 
       RowBox[{"x1", "*", "dx2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w1", "=", 
      RowBox[{"x1", "*", "x2"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ddw2", "=", 
      RowBox[{"0.0", "+", "ddw1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw2", "=", 
      RowBox[{"dx3", "+", "dw1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w2", "=", 
      RowBox[{"x3", "+", "w1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ddw3", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "x3", "]"}]}], "*", "dy3", "*", "dx3"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dw3", "=", 
      RowBox[{
       RowBox[{"Cos", "[", "x3", "]"}], "*", "dx3"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w3", "=", 
      RowBox[{"Sin", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ddw4", "=", 
      RowBox[{"0.0", "+", "ddw3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw4", "=", 
      RowBox[{"dx1", "+", "dw3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w4", "=", 
      RowBox[{"x1", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ddw5", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "w4", "]"}]}], "*", "dw4", "*", "dw4"}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "w4", "]"}], "*", "ddw4"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dw5", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "w4", "]"}]}], "*", "dw4"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w5", "=", 
      RowBox[{"Cos", "[", "w4", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w2", ",", "w5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dw2", ",", "dw5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ddw2", ",", "ddw5"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9443944007735624`*^9, 3.9443944965230265`*^9}, {
   3.944394594933754*^9, 3.944394600058935*^9}, {3.9443947930284047`*^9, 
   3.944394945212783*^9}, {3.944394997474428*^9, 3.944395016957123*^9}, {
   3.9443954548310676`*^9, 3.9443954604371734`*^9}, {3.944397187184567*^9, 
   3.944397348678116*^9}, 3.945871845612543*^9, {3.945871898417375*^9, 
   3.945871911319112*^9}, {3.945871958742979*^9, 3.9458719687236843`*^9}, {
   3.9458720259192104`*^9, 3.945872032618576*^9}, {3.945872074083477*^9, 
   3.945872082850174*^9}, {3.9458723584579506`*^9, 3.945872516367836*^9}, {
   3.9458726049976*^9, 3.945872698905951*^9}, {3.945872738008288*^9, 
   3.9458727637557335`*^9}, {3.9458728221836853`*^9, 3.945872827819024*^9}, 
   3.946030720422698*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"5716ae98-7d77-4486-be53-8b11f376cb99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Gradf", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "]"}], "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GradGradf", "[", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "]"}], "=", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", "2"}], "}"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", 
     RowBox[{"-", "0.4"}], ",", 
     RowBox[{"-", "0.6"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{"{", 
    RowBox[{"1.2", ",", 
     RowBox[{"-", "3.6"}], ",", 
     RowBox[{"-", "3.4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.2"}], ",", "3.2", ",", "3.1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f1", ",", "f2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"df1", ",", "df2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ddf1", ",", "ddf2"}], "}"}]}], "}"}], "=", 
   RowBox[{"ddf", "[", 
    RowBox[{"x", ",", "dx", ",", "dy"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gradf", "[", "x", "]"}], ".", "dx"}], "-", 
  RowBox[{"{", 
   RowBox[{"df1", ",", "df2"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"GradGradf", "[", "x", "]"}], ".", "dx"}], ")"}], ".", 
  "dy"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Gradf", "[", 
      RowBox[{"x", "+", 
       RowBox[{"g", " ", "dy"}]}], "]"}], ".", "dx"}], ",", "g"}], "]"}], "/.", 
  RowBox[{"g", "->", "0"}]}]}], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
   3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
   3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
   3.94439753632368*^9, 3.9443976489404154`*^9}, {3.944397708899124*^9, 
   3.94439780474932*^9}, {3.9458639055555763`*^9, 3.9458639262306943`*^9}, {
   3.9458711768383083`*^9, 3.94587117720055*^9}, {3.945871295316576*^9, 
   3.9458713069038963`*^9}, {3.9458729101810083`*^9, 
   3.9458729312445664`*^9}, {3.945872963766496*^9, 3.945873008407934*^9}, {
   3.9458730994316664`*^9, 3.9458731066351447`*^9}, {3.945873138000715*^9, 
   3.945873175911249*^9}, {3.945876013950308*^9, 3.9458760177916594`*^9}, {
   3.9460326070703397`*^9, 3.946032755204342*^9}, {3.9460332463318906`*^9, 
   3.9460332833334227`*^9}, {3.9460343986636844`*^9, 3.946034409652857*^9}, 
   3.946034490271516*^9},
 CellLabel->
  "In[156]:=",ExpressionUUID->"02960766-a3dc-43a7-a084-b0bb120da045"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"ddf1", ",", "ddf2"}], "}"}]], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
   3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
   3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
   3.94439753632368*^9, 3.9443976489404154`*^9}, {3.944397708899124*^9, 
   3.94439780474932*^9}, {3.9458639055555763`*^9, 3.9458639262306943`*^9}, {
   3.9458711768383083`*^9, 3.94587117720055*^9}, {3.945871295316576*^9, 
   3.9458713069038963`*^9}, {3.9458729101810083`*^9, 
   3.9458729312445664`*^9}, {3.945872963766496*^9, 3.945873008407934*^9}, {
   3.9458730994316664`*^9, 3.9458731066351447`*^9}, {3.945873138000715*^9, 
   3.945873175911249*^9}, {3.945876013950308*^9, 3.9458760177916594`*^9}, {
   3.9460326070703397`*^9, 3.946032755204342*^9}, {3.9460332463318906`*^9, 
   3.9460332833334227`*^9}, {3.9460343986636844`*^9, 3.946034409652857*^9}, 
   3.946034490271516*^9},ExpressionUUID->"754b1216-8bfc-4aee-b4e7-\
984355a223ed"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"h", ",", "g"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", "+", 
        RowBox[{"h", " ", "dx"}], " ", "+", " ", 
        RowBox[{"g", " ", "dy"}]}], "]"}], ",", "h"}], "]"}], ",", "g"}], 
   "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"h", "->", "0"}], ",", 
    RowBox[{"g", "->", "0"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Gradf", "[", 
      RowBox[{"x", "+", " ", 
       RowBox[{"g", " ", "dy"}]}], "]"}], ".", "dx"}], ",", "g"}], "]"}], "/.", 
  RowBox[{"g", "->", "0.0"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"ddf1", ",", "ddf2"}], "}"}]}], "Input",
 CellChangeTimes->{{3.9458761604248657`*^9, 3.94587623575401*^9}, {
  3.9460308748475056`*^9, 3.9460308983435326`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"8555af3f-9de2-4b6f-bfda-adc24ac8c7b6"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Gradf", "[", 
         RowBox[{"x", "+", " ", 
          RowBox[{"g", " ", "dy"}]}], "]"}], ".", "dx"}], ")"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Gradf", "[", 
         RowBox[{"x", "+", " ", 
          RowBox[{"g", " ", "dy"}]}], "]"}], ".", "dx"}], ")"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"df1", "+", 
      RowBox[{"g", " ", "ddf1"}]}], ",", 
     RowBox[{"df2", "+", 
      RowBox[{"g", " ", "ddf2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"g", ",", " ", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\[Del]\!\(\*SubscriptBox[\(f\), \(1\)]\)\>\"", ",", 
      "\"\<\[Del]\!\(\*SubscriptBox[\(f\), \(2\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(t\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(t\), \(2\)]\)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
  3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
  3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
  3.94439753632368*^9, 3.9443976489404154`*^9}, {3.944397708899124*^9, 
  3.94439780474932*^9}, {3.9458639055555763`*^9, 3.9458639262306943`*^9}, {
  3.9458711768383083`*^9, 3.94587117720055*^9}, {3.945871295316576*^9, 
  3.9458713069038963`*^9}, {3.9458729101810083`*^9, 3.9458729312445664`*^9}, {
  3.945872963766496*^9, 3.9458729753099165`*^9}, {3.945873270452848*^9, 
  3.9458733378316383`*^9}, {3.9458733696472006`*^9, 3.945873374440369*^9}, {
  3.9458734205607624`*^9, 3.9458734288379583`*^9}, {3.9458735180682707`*^9, 
  3.9458735977976604`*^9}},ExpressionUUID->"8212e71f-6663-42be-8757-\
b4b2a2ce8923"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", "+", " ", 
        RowBox[{"h", " ", "dx"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", "+", " ", 
        RowBox[{"h", " ", "dx"}]}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"f1", "+", 
      RowBox[{"h", " ", "df1"}]}], ",", 
     RowBox[{"f2", "+", 
      RowBox[{"h", " ", "df2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"h", ",", " ", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(f\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(f\), \(2\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(t\), \(1\)]\)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(t\), \(2\)]\)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
  3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
  3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
  3.94439753632368*^9, 3.9443976489404154`*^9}, {3.944397708899124*^9, 
  3.94439780474932*^9}, {3.9458639055555763`*^9, 3.9458639262306943`*^9}, {
  3.9458711768383083`*^9, 3.94587117720055*^9}, {3.945871295316576*^9, 
  3.9458713069038963`*^9}, {3.9458729101810083`*^9, 3.9458729312445664`*^9}, {
  3.945872963766496*^9, 3.9458729753099165`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"cccb6a62-6d1d-48fb-9329-afadb9823fa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"{", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"w1", "=", 
      RowBox[{"x1", "*", "x2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w2", "=", 
      RowBox[{"x3", "+", "w1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w3", "=", 
      RowBox[{"Sin", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w4", "=", 
      RowBox[{"x1", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w5", "=", 
      RowBox[{"Cos", "[", "w4", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"w2", ",", "w5"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9443944007735624`*^9, 3.9443944965230265`*^9}, {
  3.9443946263083897`*^9, 3.944394674524691*^9}, {3.9443948042845483`*^9, 
  3.9443948045656834`*^9}, {3.944394981300975*^9, 3.944394988748415*^9}, {
  3.9443968856059637`*^9, 3.9443970429327793`*^9}, {3.94542656840691*^9, 
  3.94542657106248*^9}, {3.9454266226961503`*^9, 3.945426631226261*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6baa5eb3-7d5b-4725-a5ac-76bd9ea3ef3b"],

Cell["\<\
Functions always need to be tested.  This is far from a complete test! \
\>", "Text",
 CellChangeTimes->{{3.9443947345638638`*^9, 3.9443947526118803`*^9}, {
  3.9443975001791945`*^9, 
  3.94439750379774*^9}},ExpressionUUID->"a2c59d8a-df8f-4412-a2ee-\
1eca8599d1b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "1.4", ",", "0.6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", "x", "]"}]}], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
  3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
  3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
  3.944397676777595*^9, 3.944397698376417*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"23c1acd6-16d4-4949-8c73-54b706ae3108"],

Cell["\<\
Here is a forward mode Algorithmic Differentiation (AD) code for the \
function. \
\>", "Text",
 CellChangeTimes->{{3.944394540049657*^9, 3.944394585020705*^9}, {
  3.944397177532831*^9, 3.9443971780508604`*^9}, {3.944397829764095*^9, 
  3.9443978313808312`*^9}},ExpressionUUID->"7c8b097e-1521-4875-897d-\
4dd95886bb47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"df", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"dx1_", ",", "dx2_", ",", "dx3_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5", ",", "dw1", ",", "dw2",
       ",", "dw3", ",", "dw4", ",", "dw5"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dw1", "=", 
      RowBox[{
       RowBox[{"dx1", "*", "x2"}], "+", 
       RowBox[{"x1", "*", "dx2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w1", "=", 
      RowBox[{"x1", "*", "x2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw2", "=", 
      RowBox[{"dx3", "+", "dw1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w2", "=", 
      RowBox[{"x3", "+", "w1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw3", "=", 
      RowBox[{
       RowBox[{"Cos", "[", "x3", "]"}], "*", "dx3"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w3", "=", 
      RowBox[{"Sin", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw4", "=", 
      RowBox[{"dx1", "+", "dw3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w4", "=", 
      RowBox[{"x1", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw5", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "w4", "]"}]}], "*", "dw4"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w5", "=", 
      RowBox[{"Cos", "[", "w4", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w2", ",", "w5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dw2", ",", "dw5"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9443944007735624`*^9, 3.9443944965230265`*^9}, {
  3.944394594933754*^9, 3.944394600058935*^9}, {3.9443947930284047`*^9, 
  3.944394945212783*^9}, {3.944394997474428*^9, 3.944395016957123*^9}, {
  3.9443954548310676`*^9, 3.9443954604371734`*^9}, {3.944397187184567*^9, 
  3.944397348678116*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"399f7849-9931-43d7-8e37-ecb2d93b4685"],

Cell["We need to test this trick. ", "Text",
 CellChangeTimes->{{3.9443951645385656`*^9, 
  3.9443951938215485`*^9}},ExpressionUUID->"5845354c-c66c-45da-a246-\
489ae1ddc581"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "1.4", ",", "0.6"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{"{", 
    RowBox[{"0.2", ",", "1.6", ",", 
     RowBox[{"-", "3.4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f1", ",", "f2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"df1", ",", "df2"}], "}"}]}], "}"}], "=", 
  RowBox[{"df", "[", 
   RowBox[{"x", ",", "dx"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", "+", " ", 
        RowBox[{"h", " ", "dx"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"x", "+", " ", 
        RowBox[{"h", " ", "dx"}]}], "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"f1", "+", 
      RowBox[{"h", " ", "df1"}]}], ",", 
     RowBox[{"f2", "+", 
      RowBox[{"h", " ", "df2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"h", ",", " ", 
     RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{"\"\<1\>\"", ",", "\"\<2\>\""}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.944394681806871*^9, 3.944394717308714*^9}, {
  3.9443947591518145`*^9, 3.944394763538267*^9}, {3.9443971322527585`*^9, 
  3.9443971639076414`*^9}, {3.9443974856199307`*^9, 3.944397491926385*^9}, {
  3.94439753632368*^9, 3.9443976489404154`*^9}, {3.944397708899124*^9, 
  3.94439780474932*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"dd0e6c09-53e5-484c-98f9-bb69ae2457b7"],

Cell["\<\
You can do the same thing again to get directional second derivatives as \
well. \
\>", "Text",
 CellChangeTimes->{{3.9443952715892515`*^9, 3.94439530538078*^9}, {
  3.945420373959197*^9, 
  3.9454203827038794`*^9}},ExpressionUUID->"9c2358fd-ea4d-438f-b41f-\
3b01ea512ea7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Break", "Section",
 CellChangeTimes->{{3.9463026899558926`*^9, 
  3.946302690884325*^9}},ExpressionUUID->"23e3207a-b26d-4a68-9418-\
5c9cd31bbde6"],

Cell[CellGroupData[{

Cell["Basic Example: Backward Mode", "Subsection",
 CellChangeTimes->{{3.9443952047499743`*^9, 3.944395213314677*^9}, {
  3.9443967397979164`*^9, 3.944396740587636*^9}, {3.945420391866824*^9, 
  3.9454204173032103`*^9}},ExpressionUUID->"1fe1d8f8-8cf4-4aa1-b05e-\
bd5146f0141b"],

Cell["\<\
Backwards mode computes and stores the multipliers for the derivatives.  It \
then works backwards from seeds of the output to compute derivatives. One way \
to think about this is as backsubstitution in a triangular matrix of \
sensitivities.  \
\>", "Text",
 CellChangeTimes->{{3.945420443648234*^9, 3.9454204861388474`*^9}, {
  3.945420535816781*^9, 3.9454206142728877`*^9}, {3.9454207691375427`*^9, 
  3.945420778881156*^9}},ExpressionUUID->"d1645579-cfd6-4b98-a942-\
cc5285065df7"],

Cell[TextData[{
 "This is much clearer with an example. The function from ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "3"]}], "\[Rule]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "2"]}], TraditionalForm]],
  ExpressionUUID->"5e4c4f56-1349-4784-9095-3a9d4e4943cb"],
 "\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "[", "x", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "3"], "+", 
       RowBox[{
        SubscriptBox["x", "1"], 
        SubscriptBox["x", "2"]}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "1"], 
        SubscriptBox["x", "2"]}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{
         SubscriptBox["x", "1"], "+", 
         RowBox[{"Sin", "[", 
          SubscriptBox["x", "3"], "]"}]}], "]"}]}]}], "}"}]}], 
   TraditionalForm]],ExpressionUUID->"713500be-9a0b-48d9-b6b8-bd1638d013f9"],
 "\nis easy to implement.  Here is code to compute it in small steps. The \
work variables are stored in a sequence of \[OpenCurlyDoubleQuote]work\
\[CloseCurlyDoubleQuote] variables.  We are going to modify the forward mode \
code to store the sensitivities of the work variables are in a sparse array."
}], "Text",
 CellChangeTimes->{{3.9421541554354906`*^9, 3.9421542324986663`*^9}, {
  3.942154333286024*^9, 3.942154357739272*^9}, {3.9443940492901783`*^9, 
  3.944394184883862*^9}, {3.944394222892753*^9, 3.9443943992058945`*^9}, {
  3.944396749586152*^9, 3.9443968829222665`*^9}, {3.944396918902433*^9, 
  3.944396918902433*^9}, {3.9443970455662546`*^9, 3.9443971163269677`*^9}, {
  3.945420670560318*^9, 
  3.9454207381842957`*^9}},ExpressionUUID->"6d6865d1-91ef-4f0b-aab5-\
63f0c50da01b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Df", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"df1_", ",", "df2_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "w1", ",", "w2", ",", "w3", ",", "w4", ",", "w5", ",", "dw1", ",", "dw2",
       ",", "dw3", ",", "dw4", ",", "dw5"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dw1", "=", 
      RowBox[{
       RowBox[{"dx1", "*", "x2"}], "+", 
       RowBox[{"x1", "*", "dx2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w1", "=", 
      RowBox[{"x1", "*", "x2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw2", "=", 
      RowBox[{"dx3", "+", "dw1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w2", "=", 
      RowBox[{"x3", "+", "w1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw3", "=", 
      RowBox[{
       RowBox[{"Cos", "[", "x3", "]"}], "*", "dx3"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w3", "=", 
      RowBox[{"Sin", "[", "x3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw4", "=", 
      RowBox[{"dx1", "+", "dw3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w4", "=", 
      RowBox[{"x1", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dw5", "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "w4", "]"}]}], "*", "dw4"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"w5", "=", 
      RowBox[{"Cos", "[", "w4", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Back", " ", "Substitution"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Solving", " ", "for", " ", 
       RowBox[{"{", 
        RowBox[{"dx1", ",", "dx2", ",", "dx3"}], "}"}], " ", "for", " ", "a", 
       " ", "given", " ", 
       RowBox[{"{", 
        RowBox[{"df1", ",", "df2"}], "}"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{"w2", ",", "w5"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9443944007735624`*^9, 3.9443944965230265`*^9}, {
  3.944394594933754*^9, 3.944394600058935*^9}, {3.9443947930284047`*^9, 
  3.944394945212783*^9}, {3.944394997474428*^9, 3.944395016957123*^9}, {
  3.9443954548310676`*^9, 3.9443954604371734`*^9}, {3.944397187184567*^9, 
  3.944397348678116*^9}, {3.945420741227112*^9, 3.945420757594588*^9}, {
  3.945420799886347*^9, 3.9454208257141848`*^9}, {3.9454210978247685`*^9, 
  3.94542115389834*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"25d19e05-9a88-4fd1-a50f-846fbcb4d623"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementations and Resources", "Subsection",
 CellChangeTimes->{{3.9443952047499743`*^9, 3.944395213314677*^9}, {
  3.9443967397979164`*^9, 3.944396740587636*^9}, {3.945420391866824*^9, 
  3.9454204173032103`*^9}, {3.945421188690527*^9, 
  3.9454212078893323`*^9}},ExpressionUUID->"766f80d9-c561-44e7-8f88-\
2b2264807968"],

Cell["There are several ways to implement AD.  ", "Text",
 CellChangeTimes->{{3.9454212144637194`*^9, 
  3.9454213412070265`*^9}},ExpressionUUID->"0d436bb8-4f75-498f-ad08-\
b5e441b7f173"],

Cell["\<\
Tapenade http://www-tapenade.inria.fr:8080/tapenade/index.jsp takes C or \
Fortran code and automatically returns code (forward or reverse mode) for \
derivatives.  Not surprisingly this is called \[OpenCurlyDoubleQuote]code \
rewrite\[CloseCurlyDoubleQuote].  There are similar tools in Julia.  \
\>", "Text",
 CellChangeTimes->{{3.9454212144637194`*^9, 
  3.9454213903936353`*^9}},ExpressionUUID->"c033577a-eda3-4839-9734-\
6c1648a15e70"],

Cell[TextData[{
 "You can implement Forward Mode by overloading operators to compute with \
Dual Numbers e.g.\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "+", 
       RowBox[{"\[Epsilon]", " ", "dx"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"y", "+", 
       RowBox[{"\[Epsilon]", " ", "dy"}]}], ")"}]}], "=", 
    RowBox[{
     RowBox[{"x", " ", "y"}], " ", "+", " ", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dx", " ", "y"}], " ", "+", " ", 
        RowBox[{"y", " ", "dx"}]}], ")"}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "52629e6a-92aa-4e9a-aad5-abaac0de6d51"],
 "\nand \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"cos", "(", 
     RowBox[{"x", "+", 
      RowBox[{"\[Epsilon]", " ", "dx"}]}], ")"}], "=", 
    RowBox[{
     RowBox[{"cos", "(", "x", ")"}], "-", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"sin", "(", "x", ")"}], " ", "dx"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5f411e2e-55df-4b4b-9e98-c20b935c0192"],
 "\nSome thought is needed to do second (or higher) derivatives this way to \
label the variations in some way.  Look at \
https://www.google.com/search?q=perturbation+confusion\nfor some useful \
discussion. Julia implements forward mode AD using Dual Numbers in the \
ForwardDiff package. Add \[OpenCurlyDoubleQuote]Julia\[CloseCurlyDoubleQuote] \
to the Google query to find out that the Julia developers fell into confusion \
and then fixed it! It does seem mandatory to ignore this difficulty at first. \
 "
}], "Text",
 CellChangeTimes->{{3.9454212144637194`*^9, 3.9454216392740345`*^9}, {
  3.9454216989450707`*^9, 
  3.945421943512991*^9}},ExpressionUUID->"1abf6741-8963-4f28-b70b-\
533664186e66"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mixing it up", "Subsection",
 CellChangeTimes->{{3.9443952047499743`*^9, 3.944395213314677*^9}, {
  3.9443967397979164`*^9, 3.944396740587636*^9}, {3.945420391866824*^9, 
  3.9454204173032103`*^9}, {3.945421188690527*^9, 3.9454212078893323`*^9}, {
  3.94542208858587*^9, 
  3.9454220930818796`*^9}},ExpressionUUID->"7f85da55-a1b1-4479-a531-\
e18bf490f9cf"],

Cell[TextData[{
 "In optimization it is relatively common to compute second derivatives of an \
objective function\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], "->", 
    "\[DoubleStruckCapitalR]"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7a879d49-947a-40d4-81e2-480b4b83f241"],
 "\t\nusing \[OpenCurlyDoubleQuote]forward over reverse\
\[CloseCurlyDoubleQuote].  This does reverse mode to compute the entire \
gradient \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "=", 
    RowBox[{
     RowBox[{"\[Del]", 
      RowBox[{"f", ":", 
       SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}]}], "->", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3d11eff3-9a22-45d3-9a97-6a83cdc72eaf"],
 "\nand then does forward mode to compute directional derivatives of the \
gradient.  If you compute the directional derivatives in the directions ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5f53f037-33c9-4f86-bf0e-7f24b7058866"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["e", "2"], ",", "\[Ellipsis]", ",", 
    SubscriptBox["e", "n"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b8862e1f-72c8-4461-a209-739b9cd2984a"],
 " you get the Hessian\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"H", "=", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "1"], "g"}], ",", 
       RowBox[{
        SubscriptBox["\[PartialD]", "2"], "g"}], ",", "\[Ellipsis]", ",", 
       RowBox[{
        SubscriptBox["\[PartialD]", "n"], "g"}]}], "]"}], "\[Element]", 
     SuperscriptBox["\[DoubleStruckCapitalR]", 
      RowBox[{"n", "\[Times]", "n"}]]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "fa5fc2ff-5052-46fd-922c-22c1b693c3d6"],
 "\nOne of my interests is sampling the Hessian by computing a selection of \
directions \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", 
        SubscriptBox["u", "1"]], "g"}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", 
        SubscriptBox["u", "2"]], "g"}], ",", "\[Ellipsis]", ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", 
        SubscriptBox["u", "s"]], "g"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{"H", ".", 
      RowBox[{"[", 
       RowBox[{
        SubscriptBox["u", "1"], ",", 
        SubscriptBox["u", "2"], ",", "\[Ellipsis]", ",", 
        SubscriptBox["u", "s"]}], "]"}]}], "\[Element]", 
     SuperscriptBox["\[DoubleStruckCapitalR]", 
      RowBox[{"n", "\[Times]", "s"}]]}]}], TraditionalForm]],ExpressionUUID->
  "e712d011-443d-49df-8984-a869258f64cd"],
 "\nOf course the question is what do you do with this accurate set of mixed \
directional derivatives.  "
}], "Text",
 CellChangeTimes->{{3.9454212144637194`*^9, 3.9454213412070265`*^9}, {
  3.9454220965551744`*^9, 
  3.9454225774674625`*^9}},ExpressionUUID->"d4b240fb-b367-4aa8-8901-\
ce959562ba11"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->{"EditBar", "MultipurposeBar"},
WindowSize->{996, 575},
WindowMargins->{{Automatic, -1098.5}, {Automatic, -315}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.0 for Mac OS X ARM (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6c79f291-40c3-4303-a21a-9b93c4824411"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 379, 6, 146, "Title",ExpressionUUID->"8e791b87-b8fe-4d47-a58b-235908e2ee0d"],
Cell[962, 30, 598, 10, 191, "Text",ExpressionUUID->"52d2d1c4-50f1-4cf8-95db-0b4fd6379271"],
Cell[1563, 42, 176, 3, 53, "Text",ExpressionUUID->"333077d3-2330-4a50-a57d-0125f81e3a91"],
Cell[CellGroupData[{
Cell[1764, 49, 331, 5, 101, "Section",ExpressionUUID->"166232e8-0c31-4027-9160-5de5902d8361"],
Cell[2098, 56, 1269, 36, 92, "Text",ExpressionUUID->"8dc7ee3e-9778-4aba-9550-4dcf93414ed8"],
Cell[3370, 94, 2654, 79, 202, "Text",ExpressionUUID->"57cf2e6f-1098-42db-8dd3-1e1c7ce79211"],
Cell[6027, 175, 5054, 154, 442, "Text",ExpressionUUID->"b5b26ad2-76ac-4041-9cdc-3e684ff7e981"],
Cell[11084, 331, 324, 7, 87, "Text",ExpressionUUID->"4b5dd14f-980f-403c-bb7b-281cfc75fd14"],
Cell[11411, 340, 3249, 91, 372, "Input",ExpressionUUID->"8d413ed4-3246-4e9f-93f1-296a522ed9a1"]
}, Closed]],
Cell[CellGroupData[{
Cell[14697, 436, 174, 3, 78, "Section",ExpressionUUID->"2a35e951-2dc0-473d-a920-8b69810e70d7"],
Cell[14874, 441, 980, 20, 227, "Text",ExpressionUUID->"290e7fd3-fd3f-4d5a-848d-ec08f4a63f9b"],
Cell[CellGroupData[{
Cell[15879, 465, 274, 4, 81, "Subsection",ExpressionUUID->"91b136c6-116b-4d23-bc27-00d942db8794"],
Cell[16156, 471, 1648, 44, 159, "Text",ExpressionUUID->"5abd1488-9fad-4274-ba48-14a0ca25ad96"],
Cell[17807, 517, 1302, 30, 288, "Input",ExpressionUUID->"6baa5eb3-7d5b-4725-a5ac-76bd9ea3ef3b",
 InitializationCell->True],
Cell[19112, 549, 275, 6, 53, "Text",ExpressionUUID->"a2c59d8a-df8f-4412-a2ee-1eca8599d1b1"],
Cell[19390, 557, 542, 12, 78, "Input",ExpressionUUID->"23c1acd6-16d4-4949-8c73-54b706ae3108"],
Cell[19935, 571, 330, 7, 53, "Text",ExpressionUUID->"7c8b097e-1521-4875-897d-4dd95886bb47"],
Cell[20268, 580, 2445, 61, 660, "Input",ExpressionUUID->"399f7849-9931-43d7-8e37-ecb2d93b4685",
 InitializationCell->True],
Cell[22716, 643, 174, 3, 53, "Text",ExpressionUUID->"5845354c-c66c-45da-a246-489ae1ddc581"],
Cell[22893, 648, 2231, 58, 233, "Input",ExpressionUUID->"dd0e6c09-53e5-484c-98f9-bb69ae2457b7"],
Cell[25127, 708, 231, 6, 53, "Text",ExpressionUUID->"d13fbf2c-9e02-45fd-b847-1371eb117fc0"],
Cell[25361, 716, 1413, 40, 202, "Input",ExpressionUUID->"a1aafdcf-069e-48bc-83ff-e6ce8f52924e"],
Cell[26777, 758, 295, 6, 88, "Text",ExpressionUUID->"8de9194d-0400-4df6-a2ac-99e08f043e72"],
Cell[27075, 766, 2038, 50, 353, "Input",ExpressionUUID->"1a651c6e-6de4-40e6-a58f-35c8ac0fccea"],
Cell[29116, 818, 405, 8, 53, "Text",ExpressionUUID->"9c2358fd-ea4d-438f-b41f-3b01ea512ea7"],
Cell[29524, 828, 952, 20, 192, "Text",ExpressionUUID->"b7e4eba0-7796-4905-b686-ca49be55365d"],
Cell[30479, 850, 6229, 161, 614, "Input",ExpressionUUID->"cce023f8-8b9b-45f8-9022-801be4d573c5"],
Cell[36711, 1013, 307, 5, 53, "Text",ExpressionUUID->"b73adf86-3e3f-4b69-a89f-7f31ff34d6e7"],
Cell[37021, 1020, 3078, 82, 424, "Input",ExpressionUUID->"ae17cf82-17bc-41d0-a01c-5495e9284ddf"],
Cell[40102, 1104, 319, 7, 53, "Text",ExpressionUUID->"cff8976e-9eec-4f14-9816-c3430ad33f12"],
Cell[40424, 1113, 819, 22, 157, "Input",ExpressionUUID->"26979316-a672-4c2d-bf57-19747bdbd899"],
Cell[41246, 1137, 305, 7, 87, "Text",ExpressionUUID->"55d62b98-938e-4836-aee7-a26859274e0e"],
Cell[41554, 1146, 7240, 181, 616, "Input",ExpressionUUID->"2ae07f1b-31eb-4eca-b257-83d36c466912"],
Cell[48797, 1329, 213, 4, 52, "Text",ExpressionUUID->"810609ac-e1cf-4d54-a628-b0677d953706"],
Cell[49013, 1335, 429, 11, 71, "Input",ExpressionUUID->"a1e8fc20-924b-45d4-b7af-89b192fb20ef"],
Cell[49445, 1348, 260, 6, 42, "Input",ExpressionUUID->"f9ac4212-fa33-474d-a293-62e2f0649f46"],
Cell[49708, 1356, 3929, 95, 837, "Input",ExpressionUUID->"5716ae98-7d77-4486-be53-8b11f376cb99",
 InitializationCell->True],
Cell[53640, 1453, 3330, 94, 300, "Input",ExpressionUUID->"02960766-a3dc-43a7-a084-b0bb120da045"],
Cell[56973, 1549, 1040, 16, 42, "Input",ExpressionUUID->"754b1216-8bfc-4aee-b4e7-984355a223ed"],
Cell[58016, 1567, 1014, 29, 128, "Input",ExpressionUUID->"8555af3f-9de2-4b6f-bfda-adc24ac8c7b6"],
Cell[59033, 1598, 2057, 46, 128, "Input",ExpressionUUID->"8212e71f-6663-42be-8757-b4b2a2ce8923"],
Cell[61093, 1646, 1720, 38, 128, "Input",ExpressionUUID->"cccb6a62-6d1d-48fb-9329-afadb9823fa9"],
Cell[62816, 1686, 1346, 30, 267, "Input",ExpressionUUID->"6baa5eb3-7d5b-4725-a5ac-76bd9ea3ef3b",
 InitializationCell->True],
Cell[64165, 1718, 275, 6, 52, "Text",ExpressionUUID->"a2c59d8a-df8f-4412-a2ee-1eca8599d1b1"],
Cell[64443, 1726, 538, 11, 71, "Input",ExpressionUUID->"23c1acd6-16d4-4949-8c73-54b706ae3108"],
Cell[64984, 1739, 330, 7, 52, "Text",ExpressionUUID->"7c8b097e-1521-4875-897d-4dd95886bb47"],
Cell[65317, 1748, 2229, 56, 438, "Input",ExpressionUUID->"399f7849-9931-43d7-8e37-ecb2d93b4685",
 InitializationCell->True],
Cell[67549, 1806, 174, 3, 52, "Text",ExpressionUUID->"5845354c-c66c-45da-a246-489ae1ddc581"],
Cell[67726, 1811, 1893, 51, 243, "Input",ExpressionUUID->"dd0e6c09-53e5-484c-98f9-bb69ae2457b7"],
Cell[69622, 1864, 283, 7, 52, "Text",ExpressionUUID->"9c2358fd-ea4d-438f-b41f-3b01ea512ea7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69954, 1877, 152, 3, 100, "Section",ExpressionUUID->"23e3207a-b26d-4a68-9418-5c9cd31bbde6"],
Cell[CellGroupData[{
Cell[70131, 1884, 277, 4, 81, "Subsection",ExpressionUUID->"1fe1d8f8-8cf4-4aa1-b05e-bd5146f0141b"],
Cell[70411, 1890, 496, 9, 121, "Text",ExpressionUUID->"d1645579-cfd6-4b98-a942-cc5285065df7"],
Cell[70910, 1901, 1754, 43, 190, "Text",ExpressionUUID->"6d6865d1-91ef-4f0b-aab5-63f0c50da01b"],
Cell[72667, 1946, 2668, 65, 495, "Input",ExpressionUUID->"25d19e05-9a88-4fd1-a50f-846fbcb4d623",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[75372, 2016, 329, 5, 81, "Subsection",ExpressionUUID->"766f80d9-c561-44e7-8f88-2b2264807968"],
Cell[75704, 2023, 187, 3, 52, "Text",ExpressionUUID->"0d436bb8-4f75-498f-ad08-b5e441b7f173"],
Cell[75894, 2028, 450, 8, 121, "Text",ExpressionUUID->"c033577a-eda3-4839-9734-6c1648a15e70"],
Cell[76347, 2038, 1818, 47, 328, "Text",ExpressionUUID->"1abf6741-8963-4f28-b70b-533664186e66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78202, 2090, 362, 6, 81, "Subsection",ExpressionUUID->"7f85da55-a1b1-4479-a531-e18bf490f9cf"],
Cell[78567, 2098, 3183, 88, 364, "Text",ExpressionUUID->"d4b240fb-b367-4aa8-8901-ce959562ba11"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

