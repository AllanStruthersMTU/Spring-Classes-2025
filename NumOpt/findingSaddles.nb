(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46947,       1140]
NotebookOptionsPosition[     42516,       1063]
NotebookOutlinePosition[     43072,       1083]
CellTagsIndexPosition[     43029,       1080]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Finding Critical Points of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", ":", 
     SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], "\[Rule]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", "n"]}], TraditionalForm]],
  ExpressionUUID->"b501ae90-7a1d-4dab-8a70-6e406bf5dd24"],
 "."
}], "Title",
 CellChangeTimes->{{3.9398152070839567`*^9, 3.9398152117860727`*^9}, {
  3.9421541444318066`*^9, 3.9421541513390083`*^9}, {3.944393994649187*^9, 
  3.9443940027240753`*^9}, {3.9443979907577295`*^9, 3.944397995195145*^9}, {
  3.9454196831749916`*^9, 3.9454196934074483`*^9}, {3.9476696957952847`*^9, 
  3.947669724002763*^9}},ExpressionUUID->"8e791b87-b8fe-4d47-a58b-\
235908e2ee0d"],

Cell[CellGroupData[{

Cell["Rosenbrock", "Section",
 CellChangeTimes->{{3.9476758874776926`*^9, 
  3.9476758940878534`*^9}},ExpressionUUID->"a53e7322-fd27-452c-a7ed-\
bed472b4181b"],

Cell["Here is the Rosenbrock function.", "Text",
 CellChangeTimes->{{3.9476739679055586`*^9, 
  3.9476739754257336`*^9}},ExpressionUUID->"29286223-5746-44e5-83c8-\
c36ad31367f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rosen", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ",", 
      RowBox[{"eta", "=", "100.0"}], ",", 
      RowBox[{"sum", "=", "0.0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"sum", "+=", 
        RowBox[{
         RowBox[{"eta", "*", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
             SuperscriptBox[
              RowBox[{
              "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "2"]}], ")"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
           ")"}], "2"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "sum"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.947673333745247*^9, 3.9476733691184545`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0bc216eb-1141-42b7-a225-aaf4fe63c378"],

Cell["\<\
Here are a symbolic gradient and Hessian in a fixed dimension.\
\>", "Text",
 CellChangeTimes->{{3.9476739788659716`*^9, 
  3.947674016705764*^9}},ExpressionUUID->"2e724005-b8ac-482e-abfe-\
580809bd7b5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "23"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dRosen", "[", "x_List", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Rosen", "[", "var", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"var", ",", "1"}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":>", 
      RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddRosen", "[", "x_List", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Rosen", "[", "var", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"var", ",", "2"}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":>", 
      RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
     "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.947673333745247*^9, 3.9476734476036453`*^9}, {
  3.947673567827385*^9, 3.9476736724118986`*^9}, {3.9476737095794587`*^9, 
  3.9476737248806815`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"971b5e9d-7c23-4f82-8255-448de9b184c9"],

Cell["\<\
Here is a random initial condition and a built in numerical solve! It is a \
Newton like solver. \
\>", "Text",
 CellChangeTimes->{{3.947674022671896*^9, 
  3.9476740718982544`*^9}},ExpressionUUID->"c0f07893-f9e4-4ec2-851d-\
d569b281111d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"xCP", "=", 
  RowBox[{"x", "/.", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"dRosen", "[", "x", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "x0"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{"dRosen", "[", "xCP", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.947673333745247*^9, 3.9476734868333454`*^9}, {
  3.9476735300372233`*^9, 3.947673576091086*^9}, {3.947673686225071*^9, 
  3.947673706921859*^9}, {3.9476737528919086`*^9, 3.9476737579400816`*^9}, {
  3.947673821889621*^9, 3.947673835620413*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"1e968bbe-2bde-48ea-abc9-eea4f422b48d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.5553760760845025`"}], ",", "0.3224454943940813`", ",", 
   "0.11517820561707512`", ",", "0.02350619775990889`", ",", 
   "0.010661379291372555`", ",", "0.010217974463583124`", ",", 
   "0.010208620932226726`", ",", "0.010208427900041556`", ",", 
   "0.010208423918228847`", ",", "0.010208423836093944`", ",", 
   "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
   "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
   "0.010208423834363699`", ",", "0.01020842383434829`", ",", 
   "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
   "0.010208422041661192`", ",", "0.01020833692600336`", ",", 
   "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
   "0.0001000817179434254`"}], "}"}]], "Output",
 CellChangeTimes->{{3.947673470886091*^9, 3.947673487965023*^9}, {
   3.9476735237780056`*^9, 3.9476735764907675`*^9}, 3.947673623693177*^9, {
   3.9476736797592807`*^9, 3.9476737028098807`*^9}, {3.947673734673353*^9, 
   3.947673917886665*^9}, 3.947684939700335*^9, {3.947685085131197*^9, 
   3.9476850907104855`*^9}},
 CellLabel->"Out[16]=",ExpressionUUID->"a4b15b5f-3937-4689-878d-e5593e8526e9"],

Cell[BoxData["1.3387018305520948`*^-14"], "Output",
 CellChangeTimes->{{3.947673470886091*^9, 3.947673487965023*^9}, {
   3.9476735237780056`*^9, 3.9476735764907675`*^9}, 3.947673623693177*^9, {
   3.9476736797592807`*^9, 3.9476737028098807`*^9}, {3.947673734673353*^9, 
   3.947673917886665*^9}, 3.947684939700335*^9, {3.947685085131197*^9, 
   3.9476850907165003`*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"24de3e75-c45a-4a53-a256-a34b3c4fa20c"]
}, Open  ]],

Cell["I saved one of saddles I found. ", "Text",
 CellChangeTimes->{{3.9476740786662083`*^9, 3.947674090354039*^9}, {
  3.9476749092949033`*^9, 
  3.9476749153353014`*^9}},ExpressionUUID->"f23d653f-5b63-4dbe-a3bb-\
82b9196be8b8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xSa", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845025`"}], ",", "0.32244549439408127`", ",", 
     "0.11517820561707508`", ",", "0.02350619775990888`", ",", 
     "0.010661379291372555`", ",", "0.010217974463583123`", ",", 
     "0.010208620932226723`", ",", "0.010208427900041554`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093945`", ",", 
     "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364039`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.010208423834348288`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.01020842204166119`", ",", "0.010208336926003357`", ",", 
     "0.010204210572710551`", ",", "0.010004085062784374`", ",", 
     "0.00010008171794342543`"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{"dRosen", "[", "xSa", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", 
  RowBox[{"H", "=", 
   RowBox[{"ddRosen", "[", "xSa", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "H", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9476739253077993`*^9, 3.947673943362593*^9}, {
   3.947674097584085*^9, 3.947674118538599*^9}, {3.947685389387394*^9, 
   3.9476854033668537`*^9}, 3.9476855423965235`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"5be9dca1-e472-49e4-933a-9929c11981b6"],

Cell[BoxData["3.4470732051102004`*^-15"], "Output",
 CellChangeTimes->{{3.947674105961317*^9, 3.9476741191003704`*^9}, 
   3.9476852983608074`*^9, {3.9476853953123083`*^9, 3.9476854049173355`*^9}, 
   3.9476855429687333`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"3b3fed18-c537-4780-adae-f773acb18231"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "516.4717571058964`", ",", "249.44529085434598`", ",", 
   "207.01873605321754`", ",", "206.06877598498477`", ",", 
   "205.66935650763162`", ",", "205.04297447145785`", ",", 
   "204.21823309691453`", ",", "203.22452009787492`", ",", 
   "202.09686227589665`", ",", "200.87942643235658`", ",", 
   "199.6308589894873`", ",", "198.4235925789236`", ",", 
   "197.28231968972523`", ",", "196.12359228653662`", ",", 
   "194.92109372231445`", ",", "193.74161689741274`", ",", 
   "192.65166182933575`", ",", "191.69976391839128`", ",", 
   "190.9223697314851`", ",", "190.3471671409`", ",", "189.99401194405928`", 
   ",", "166.57951322442665`", ",", 
   RowBox[{"-", "2.8115745771977476`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.947674105961317*^9, 3.9476741191003704`*^9}, 
   3.9476852983608074`*^9, {3.9476853953123083`*^9, 3.9476854049173355`*^9}, 
   3.9476855429857445`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"c35f7855-bc9f-4a44-b14e-5998002104a3"]
}, Open  ]],

Cell[TextData[{
 "I am going to run this ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", "2"], TraditionalForm]],ExpressionUUID->
  "7e5e3268-04db-4f81-a707-d7127c983905"],
 " times and keep all the output that I get. "
}], "Text",
 CellChangeTimes->{{3.947674943238885*^9, 3.9476750093207407`*^9}, {
  3.9476750995228806`*^9, 3.9476750995228806`*^9}, {3.947675150171467*^9, 
  3.9476751503652515`*^9}},ExpressionUUID->"85f0d2d3-fe75-4965-bec8-\
465b7cfa61ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SampleSize", "=", 
   SuperscriptBox["10", "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewtOutput", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"x0", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "n"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", " ", 
       RowBox[{"x", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"dRosen", "[", "x", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "x0"}], "}"}]}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "SampleSize", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.947673333745247*^9, 3.9476734868333454`*^9}, {
  3.9476735300372233`*^9, 3.947673576091086*^9}, {3.947673686225071*^9, 
  3.947673706921859*^9}, {3.9476737528919086`*^9, 3.9476737579400816`*^9}, {
  3.947673821889621*^9, 3.947673835620413*^9}, {3.9476749918719854`*^9, 
  3.947675031039975*^9}, {3.9476750761582813`*^9, 3.9476751350936337`*^9}, {
  3.9476751754216576`*^9, 3.9476751776451874`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"b0032806-34f5-493c-838c-4d3889ed98a0"],

Cell["\<\
It is why I turned of the warnings. Some of these did not converge!  I need \
to find the ones that converged and see if any of them are saddles.  \
\>", "Text",
 CellChangeTimes->{{3.9476751879727974`*^9, 3.947675253917347*^9}, {
  3.947675298084654*^9, 
  3.947675349159638*^9}},ExpressionUUID->"3a79fd09-4f15-4226-a50f-\
62b9328a63cf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"residuals", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{"dRosen", "[", "#", "]"}], "]"}], "&"}], ",", "NewtOutput"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tol", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "10"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"residuals", ",", "Tol"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Position", "[", 
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{"residuals", ",", "Tol"}], "]"}], ",", "0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"conv", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Position", "[", 
    RowBox[{
     RowBox[{"Chop", "[", 
      RowBox[{"residuals", ",", "Tol"}], "]"}], ",", "0"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewtOutput", "\[LeftDoubleBracket]", "conv", 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.947675258120827*^9, 3.947675276321054*^9}, {
   3.947675355210313*^9, 3.947675509120033*^9}, {3.947675555702527*^9, 
   3.9476755596961803`*^9}, 3.9476858590594063`*^9, {3.9476859098304443`*^9, 
   3.947685935212359*^9}, {3.9476859688567567`*^9, 3.9476859712401104`*^9}, {
   3.9476860282617188`*^9, 3.9476860287046156`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"8f8e0742-eb16-4dae-8dde-fc820a112f4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "19", "}"}], ",", 
   RowBox[{"{", "22", "}"}], ",", 
   RowBox[{"{", "47", "}"}], ",", 
   RowBox[{"{", "49", "}"}], ",", 
   RowBox[{"{", "50", "}"}], ",", 
   RowBox[{"{", "54", "}"}], ",", 
   RowBox[{"{", "57", "}"}], ",", 
   RowBox[{"{", "94", "}"}], ",", 
   RowBox[{"{", "100", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9476750712005796`*^9, 3.9476750964299574`*^9}, 
   3.94767515014701*^9, 3.94767527738167*^9, 3.9476753579662757`*^9, {
   3.9476754255206738`*^9, 3.9476755095379725`*^9}, 3.9476755604118786`*^9, 
   3.947685790460808*^9, {3.9476858340529237`*^9, 3.9476858596238976`*^9}, 
   3.947685935760376*^9, 3.9476860296637664`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"65d8f952-f78d-4e12-9a92-f14341ee6988"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "19", ",", "22", ",", "47", ",", "49", ",", "50", ",", "54", ",", "57", ",",
    "94", ",", "100"}], "}"}]], "Output",
 CellChangeTimes->{{3.9476750712005796`*^9, 3.9476750964299574`*^9}, 
   3.94767515014701*^9, 3.94767527738167*^9, 3.9476753579662757`*^9, {
   3.9476754255206738`*^9, 3.9476755095379725`*^9}, 3.9476755604118786`*^9, 
   3.947685790460808*^9, {3.9476858340529237`*^9, 3.9476858596238976`*^9}, 
   3.947685935760376*^9, 3.9476860296712894`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"3d327780-9658-43d7-b418-0e7c3163eaa6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845033`"}], ",", "0.3224454943940825`", ",", 
     "0.11517820561707573`", ",", "0.023506197759908972`", ",", 
     "0.010661379291372557`", ",", "0.010217974463583124`", ",", 
     "0.010208620932226726`", ",", "0.010208427900041554`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093945`", ",", 
     "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
     "0.0001000817179434254`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845025`"}], ",", "0.3224454943940813`", ",", 
     "0.11517820561707513`", ",", "0.023506197759908892`", ",", 
     "0.010661379291372557`", ",", "0.010217974463583121`", ",", 
     "0.010208620932226724`", ",", "0.010208427900041556`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093944`", ",", 
     "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
     "0.0001000817179434254`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845025`"}], ",", "0.3224454943940813`", ",", 
     "0.11517820561707512`", ",", "0.023506197759908885`", ",", 
     "0.010661379291372557`", ",", "0.010217974463583121`", ",", 
     "0.010208620932226726`", ",", "0.010208427900041554`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093944`", ",", 
     "0.010208423834399707`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784374`", ",", 
     "0.00010008171794342543`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845026`"}], ",", "0.32244549439408143`", ",", 
     "0.11517820561707517`", ",", "0.0235061977599089`", ",", 
     "0.010661379291372557`", ",", "0.010217974463583121`", ",", 
     "0.010208620932226724`", ",", "0.010208427900041556`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093944`", ",", 
     "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
     "0.0001000817179434254`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845025`"}], ",", "0.3224454943940813`", ",", 
     "0.11517820561707512`", ",", "0.02350619775990889`", ",", 
     "0.010661379291372555`", ",", "0.010217974463583121`", ",", 
     "0.010208620932226726`", ",", "0.010208427900041558`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093944`", ",", 
     "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784374`", ",", 
     "0.00010008171794342543`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845026`"}], ",", "0.3224454943940811`", ",", 
     "0.115178205617075`", ",", "0.02350619775990891`", ",", 
     "0.010661379291372576`", ",", "0.010217974463583124`", ",", 
     "0.010208620932226726`", ",", "0.010208427900041556`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093945`", ",", 
     "0.010208423834399707`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
     "0.0001000817179434254`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845052`"}], ",", "0.32244549439408404`", ",", 
     "0.1151782056170769`", ",", "0.023506197759909354`", ",", 
     "0.01066137929137261`", ",", "0.010217974463583126`", ",", 
     "0.010208620932226724`", ",", "0.010208427900041556`", ",", 
     "0.010208423918228848`", ",", "0.010208423836093945`", ",", 
     "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
     "0.0001000817179434254`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845025`"}], ",", "0.32244549439408127`", ",", 
     "0.11517820561707508`", ",", "0.02350619775990888`", ",", 
     "0.010661379291372555`", ",", "0.010217974463583124`", ",", 
     "0.010208620932226724`", ",", "0.010208427900041556`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093944`", ",", 
     "0.010208423834399707`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
     "0.0001000817179434254`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5553760760845025`"}], ",", "0.32244549439408127`", ",", 
     "0.11517820561707508`", ",", "0.023506197759908875`", ",", 
     "0.010661379291372557`", ",", "0.010217974463583123`", ",", 
     "0.010208620932226726`", ",", "0.010208427900041556`", ",", 
     "0.010208423918228847`", ",", "0.010208423836093944`", ",", 
     "0.010208423834399709`", ",", "0.010208423834364759`", ",", 
     "0.010208423834364037`", ",", "0.010208423834364017`", ",", 
     "0.010208423834363697`", ",", "0.01020842383434829`", ",", 
     "0.010208423833601238`", ",", "0.010208423797385026`", ",", 
     "0.010208422041661194`", ",", "0.01020833692600336`", ",", 
     "0.01020421057271055`", ",", "0.010004085062784373`", ",", 
     "0.0001000817179434254`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9476750712005796`*^9, 3.9476750964299574`*^9}, 
   3.94767515014701*^9, 3.94767527738167*^9, 3.9476753579662757`*^9, {
   3.9476754255206738`*^9, 3.9476755095379725`*^9}, 3.9476755604118786`*^9, 
   3.947685790460808*^9, {3.9476858340529237`*^9, 3.9476858596238976`*^9}, 
   3.947685935760376*^9, 3.947686029684589*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"da6fc5d4-c723-48ca-94a4-f1ee98b066ca"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Perturbed Quadratic Penalty Function", "Section",
 CellChangeTimes->{{3.9476756222422104`*^9, 
  3.9476756331516876`*^9}},ExpressionUUID->"92d435f4-fd08-4ce1-8b4f-\
bffaf883259c"],

Cell[TextData[{
 "At least one of the functions is boring! \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "n"], 
     SubsuperscriptBox["x", "i", "2"]}], "+", 
    RowBox[{
     FractionBox["1", "100"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[Sum]", 
         RowBox[{"i", "=", "1"}], "n"], 
        SubscriptBox["x", "i"]}], ")"}], "2"]}]}], TraditionalForm]],
  ExpressionUUID->"c694ae47-a643-442c-bdc6-e24e650781a1"],
 "\nsince it has a constant Hessian (in any dimension n) with p[ositive \
eigenvalues.  "
}], "Text",
 CellChangeTimes->{{3.9476756411600084`*^9, 3.9476757015438576`*^9}, {
  3.9476758102529335`*^9, 3.9476758709342427`*^9}, {3.947686310096032*^9, 
  3.947686310371149*^9}},ExpressionUUID->"7c40db48-138c-4f5f-a32b-\
9b3bfe08873d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"i", " ", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "100"}], ")"}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ")"}], "^", 
     "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", "var", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "H", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Eigenvalues", "[", 
  RowBox[{"N", "[", "H", "]"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9476757061134167`*^9, 3.947675803601025*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"c9f7887b-891d-4596-90f0-50dbc4ce499a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["101", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"]},
     {
      FractionBox["1", "50"], 
      FractionBox["201", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"]},
     {
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["301", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"]},
     {
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["401", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"]},
     {
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["501", "50"], 
      FractionBox["1", "50"]},
     {
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["1", "50"], 
      FractionBox["601", "50"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9476757422846556`*^9, 3.9476757675945854`*^9}, 
   3.947675804183832*^9, 3.9476863429120283`*^9},
 CellLabel->
  "Out[65]//MatrixForm=",ExpressionUUID->"595ccbd0-18a2-4c4c-a21c-\
9b31b067d7cb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "12.020464226996117`", ",", "10.020214037110856`", ",", 
   "8.020061617924524`", ",", "6.019928386001665`", ",", 
   "4.0197809607919215`", ",", "2.0195507711749143`"}], "}"}]], "Output",
 CellChangeTimes->{{3.9476757422846556`*^9, 3.9476757675945854`*^9}, 
   3.947675804183832*^9, 3.94768634291698*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"e3d2221c-0c26-470c-822b-f47069f14fc7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generalized White and Holst", "Section",
 CellChangeTimes->{{3.9476756222422104`*^9, 3.9476756331516876`*^9}, 
   3.947675937081817*^9, {3.9476760545825415`*^9, 3.9476760573662357`*^9}, {
   3.9476770211059523`*^9, 
   3.9476770254461966`*^9}},ExpressionUUID->"09fb6f4a-f19c-4c25-a619-\
2688bd3e9fcd"],

Cell[TextData[{
 "The generalized White and Holst function is \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "n"], 
     RowBox[{"100.0", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", 
          RowBox[{"i", "+", "1"}]], "-", 
         SubsuperscriptBox["x", "i", "3"]}], ")"}], "2"]}]}], "+", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SubscriptBox["x", "i"]}], ")"}], "2"]}], TraditionalForm]],
  ExpressionUUID->"63e488cd-cf50-4bb0-9919-d4cdcf8b0aaf"],
 "\nlooks kinda like the Rosenbrock function.   I found that it is much \
harder for the built-in solvers. "
}], "Text",
 CellChangeTimes->{{3.9476756411600084`*^9, 3.9476757015438576`*^9}, {
  3.9476758102529335`*^9, 3.9476758709342427`*^9}, {3.947675946030652*^9, 
  3.947675952669715*^9}, {3.9476759918235517`*^9, 3.9476760704364405`*^9}, {
  3.947676233357055*^9, 3.9476762352680717`*^9}, {3.9476765869763374`*^9, 
  3.947676615142147*^9}, {3.9476770289923906`*^9, 
  3.947677058611862*^9}},ExpressionUUID->"3068659a-0b31-4bdb-a371-\
fdf2ebe66acd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"WH", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WH", "[", "x_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"100.0", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", 
             RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], " ", "-", " ", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "^", "3"}]}], ")"}], "^", 
         "2"}]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", 
        RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "23"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dWH", "[", "x_List", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"WH", "[", "var", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"var", ",", "1"}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":>", 
      RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddWH", "[", "x_List", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"WH", "[", "var", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"var", ",", "2"}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":>", 
      RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.9", ",", "1.1"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{"dWH", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindMinimum", "[", 
  RowBox[{
   RowBox[{"WH", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x0"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9476757061134167`*^9, 3.947675803601025*^9}, {
  3.947675960576687*^9, 3.9476759693459873`*^9}, {3.9476760905192275`*^9, 
  3.947676225640135*^9}, {3.947676302468012*^9, 3.9476764768224707`*^9}, {
  3.9476765129282913`*^9, 3.947676569503644*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"29b4d9e3-fb8e-477f-b547-cd8f85100e1b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
     "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
     "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
     "1.`", ",", "1.`", ",", "1.0000000000000002`", ",", 
     "1.0000000000000004`", ",", "1.000000000000001`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.94767631553968*^9, 3.9476764826800694`*^9}, {
   3.947676529213437*^9, 3.9476765812272787`*^9}, 3.9476866430902596`*^9, {
   3.947686761373204*^9, 3.9476867687555437`*^9}},
 CellLabel->
  "Out[110]=",ExpressionUUID->"d77e8741-5397-4a1b-86dd-62930c80d385"],

Cell[BoxData[
 TemplateBox[{
  "FindMinimum", "lstol", 
   "\"The line search decreased the step size to within the tolerance \
specified by AccuracyGoal and PrecisionGoal but was unable to find a \
sufficient decrease in the function. You may need more than \\!\\(\\*RowBox[{\
\\\"MachinePrecision\\\"}]\\) digits of working precision to meet these \
tolerances.\"", 2, 111, 9, 22119360771735843352, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.947676315528976*^9, 3.9476764826720905`*^9}, {
   3.9476765292054596`*^9, 3.9476765813143015`*^9}, 3.947686643287031*^9, {
   3.947686761527794*^9, 3.947686768891658*^9}},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"32a870e1-6173-4864-b6cb-371314ada486"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.350273664032774`*^-10", ",", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "0.9999999798060002`", ",", "0.999999975360502`", ",", 
       "0.9999999802574676`", ",", "0.9999999974292803`", ",", 
       "1.0000000115309122`", ",", "1.000000016044087`", ",", 
       "1.000000001863919`", ",", "0.999999978784028`", ",", 
       "0.9999999578255596`", ",", "0.9999999505281864`", ",", 
       "0.999999951251765`", ",", "0.9999999519417526`", ",", 
       "0.9999999503955382`", ",", "0.9999999607462847`", ",", 
       "0.9999999830035959`", ",", "1.0000000039291241`", ",", 
       "0.9999999858291221`", ",", "0.9999998844583595`", ",", 
       "0.9999995995170701`", ",", "0.9999987993162353`", ",", 
       "0.9999964499761291`", ",", "0.9999894100325274`", ",", 
       "0.9999682422824149`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.94767631553968*^9, 3.9476764826800694`*^9}, {
   3.947676529213437*^9, 3.9476765812272787`*^9}, 3.9476866430902596`*^9, {
   3.947686761373204*^9, 3.9476867689026613`*^9}},
 CellLabel->
  "Out[111]=",ExpressionUUID->"b703c5fd-7955-4b1e-8b15-8b367c881d92"]
}, Open  ]],

Cell["\<\
I messed around a bit to try to find out a bit more about why\
\>", "Text",
 CellChangeTimes->{{3.9476767250393333`*^9, 
  3.9476767429342175`*^9}},ExpressionUUID->"321f7364-59ed-4487-a1f1-\
d12e72a18ea7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"AAS", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AAS", "[", "x_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"80.0", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}], "2"], " ", "-",
            " ", 
           SuperscriptBox[
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "3"]}], ")"}], "^", "2"}]}], " ",
        "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", 
        RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "23"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", "n"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dAAS", "[", "x_List", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"AAS", "[", "var", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"var", ",", "1"}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":>", 
      RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddAAS", "[", "x_List", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"AAS", "[", "var", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"var", ",", "2"}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"x", "[", "i_", "]"}], ":>", 
      RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FindRoot", "[", 
  RowBox[{
   RowBox[{"dAAS", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FindMinimum", "[", 
  RowBox[{
   RowBox[{"AAS", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x0"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9476757061134167`*^9, 3.947675803601025*^9}, {
  3.947675960576687*^9, 3.9476759693459873`*^9}, {3.9476760905192275`*^9, 
  3.947676225640135*^9}, {3.947676302468012*^9, 3.9476764768224707`*^9}, {
  3.9476765129282913`*^9, 3.947676569503644*^9}, {3.947676673455062*^9, 
  3.9476766742296457`*^9}, {3.947676754622719*^9, 3.947676995043893*^9}, {
  3.947686899262809*^9, 3.947686900602421*^9}, {3.9476869633402586`*^9, 
  3.947686970123701*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"bc175efc-9006-4508-9a11-9fe7ea10ce4b"],

Cell[BoxData[
 TemplateBox[{
  "FindRoot", "lstol", 
   "\"The line search decreased the step size to within tolerance specified \
by AccuracyGoal and PrecisionGoal but was unable to find a sufficient \
decrease in the merit function. You may need more than \
\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\) digits of working precision to \
meet these tolerances.\"", 2, 128, 12, 22119360771735843352, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.947676904264574*^9, 3.947676996168915*^9}, 
   3.947686904166762*^9, 3.9476869734622917`*^9},
 CellLabel->
  "During evaluation of \
In[121]:=",ExpressionUUID->"fc56584e-1170-4390-b0c8-ff79134aaa08"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
    "0.17196470505708114`", ",", "0.13518528155666076`", ",", 
     "0.19131344924884544`", ",", "0.1831452112987656`", ",", 
     "0.20210042209054505`", ",", "0.20455445019107452`", ",", 
     "0.20779180487815413`", ",", "0.20612124030982137`", ",", 
     "0.2062467738366942`", ",", "0.20877617134950116`", ",", 
     "0.20973956880213526`", ",", "0.20719708801485123`", ",", 
     "0.20430129781764947`", ",", "0.2079874234669249`", ",", 
     "0.1955910195373539`", ",", "0.19043276963642167`", ",", 
     "0.19914306545659352`", ",", "0.2040706963260512`", ",", 
     "0.20716399990856074`", ",", "0.2063680230329036`", ",", 
     "0.2077465175261175`", ",", "0.18636668364645187`", ",", 
     "0.08263232322589156`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9476766756428785`*^9, 3.947676716055064*^9}, {
   3.947676765843973*^9, 3.947676834434145*^9}, {3.947676867141399*^9, 
   3.947676996177891*^9}, 3.9476869041777325`*^9, 3.947686973475296*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"3a94d493-5944-4a86-af21-766f19317dd1"],

Cell[BoxData[
 TemplateBox[{
  "FindMinimum", "cvmit", 
   "\"Failed to converge to the requested accuracy or precision within \\!\\(\
\\*RowBox[{\\\"100\\\"}]\\) iterations.\"", 2, 129, 13, 22119360771735843352, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.947676904264574*^9, 3.947676996168915*^9}, 
   3.947686904166762*^9, 3.947686973731125*^9},
 CellLabel->
  "During evaluation of \
In[121]:=",ExpressionUUID->"4d18eebd-c154-486d-9e4b-bee184a3f312"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11.971230559602745`", ",", 
   RowBox[{"{", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "0.9107221776582288`", ",", "0.8695930626346956`", ",", 
       "0.8095909612608371`", ",", "0.7225504851755162`", ",", 
       "0.6101091882890105`", ",", "0.476865332256268`", ",", 
       "0.29000916508589875`", ",", "0.23841686501714784`", ",", 
       "0.2350506178854`", ",", "0.23748292139038854`", ",", 
       "0.25112164929204556`", ",", "0.252835520552539`", ",", 
       "0.23979370514515796`", ",", "0.2279973915021856`", ",", 
       "0.2196073606197981`", ",", "0.1823320647170825`", ",", 
       "0.17662797673653868`", ",", "0.17052924418818824`", ",", 
       "0.2126812152213709`", ",", "0.20973552784367208`", ",", 
       "0.2230953141114132`", ",", "0.20570497796629061`", ",", 
       RowBox[{"-", "0.09960421129063632`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9476766756428785`*^9, 3.947676716055064*^9}, {
   3.947676765843973*^9, 3.947676834434145*^9}, {3.947676867141399*^9, 
   3.947676996177891*^9}, 3.9476869041777325`*^9, 3.947686973743124*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"134fc811-b8f9-4e93-b0b3-376617dd332a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->{"EditBar", "MultipurposeBar"},
WindowSize->{1152, 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b8ed70e7-b353-4b2b-bd39-df48144485d2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 708, 16, 146, "Title",ExpressionUUID->"8e791b87-b8fe-4d47-a58b-235908e2ee0d"],
Cell[CellGroupData[{
Cell[1313, 42, 159, 3, 100, "Section",ExpressionUUID->"a53e7322-fd27-452c-a7ed-bed472b4181b"],
Cell[1475, 47, 178, 3, 52, "Text",ExpressionUUID->"29286223-5746-44e5-83c8-c36ad31367f1"],
Cell[1656, 52, 1408, 38, 168, "Input",ExpressionUUID->"0bc216eb-1141-42b7-a225-aaf4fe63c378",
 InitializationCell->True],
Cell[3067, 92, 214, 5, 52, "Text",ExpressionUUID->"2e724005-b8ac-482e-abfe-580809bd7b5a"],
Cell[3284, 99, 1392, 39, 152, "Input",ExpressionUUID->"971b5e9d-7c23-4f82-8255-448de9b184c9",
 InitializationCell->True],
Cell[4679, 140, 249, 6, 52, "Text",ExpressionUUID->"c0f07893-f9e4-4ec2-851d-d569b281111d"],
Cell[CellGroupData[{
Cell[4953, 150, 878, 22, 100, "Input",ExpressionUUID->"1e968bbe-2bde-48ea-abc9-eea4f422b48d"],
Cell[5834, 174, 1197, 20, 106, "Output",ExpressionUUID->"a4b15b5f-3937-4689-878d-e5593e8526e9"],
Cell[7034, 196, 450, 6, 48, "Output",ExpressionUUID->"24de3e75-c45a-4a53-a256-a34b3c4fa20c"]
}, Open  ]],
Cell[7499, 205, 229, 4, 52, "Text",ExpressionUUID->"f23d653f-5b63-4dbe-a3bb-82b9196be8b8"],
Cell[CellGroupData[{
Cell[7753, 213, 1446, 27, 328, "Input",ExpressionUUID->"5be9dca1-e472-49e4-933a-9929c11981b6"],
Cell[9202, 242, 304, 4, 48, "Output",ExpressionUUID->"3b3fed18-c537-4780-adae-f773acb18231"],
Cell[9509, 248, 1004, 18, 106, "Output",ExpressionUUID->"c35f7855-bc9f-4a44-b14e-5998002104a3"]
}, Open  ]],
Cell[10528, 269, 465, 11, 52, "Text",ExpressionUUID->"85f0d2d3-fe75-4965-bec8-465b7cfa61ef"],
Cell[10996, 282, 1315, 31, 157, "Input",ExpressionUUID->"b0032806-34f5-493c-838c-4d3889ed98a0"],
Cell[12314, 315, 348, 7, 87, "Text",ExpressionUUID->"3a79fd09-4f15-4226-a50f-62b9328a63cf"],
Cell[CellGroupData[{
Cell[12687, 326, 1382, 35, 186, "Input",ExpressionUUID->"8f8e0742-eb16-4dae-8dde-fc820a112f4e"],
Cell[14072, 363, 792, 17, 48, "Output",ExpressionUUID->"65d8f952-f78d-4e12-9a92-f14341ee6988"],
Cell[14867, 382, 583, 10, 48, "Output",ExpressionUUID->"3d327780-9658-43d7-b418-0e7c3163eaa6"],
Cell[15453, 394, 7752, 134, 791, "Output",ExpressionUUID->"da6fc5d4-c723-48ca-94a4-f1ee98b066ca"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23254, 534, 185, 3, 77, "Section",ExpressionUUID->"92d435f4-fd08-4ce1-8b4f-bffaf883259c"],
Cell[23442, 539, 874, 24, 126, "Text",ExpressionUUID->"7c40db48-138c-4f5f-a32b-9b3bfe08873d"],
Cell[CellGroupData[{
Cell[24341, 567, 1417, 42, 214, "Input",ExpressionUUID->"c9f7887b-891d-4596-90f0-50dbc4ce499a"],
Cell[25761, 611, 1834, 60, 251, "Output",ExpressionUUID->"595ccbd0-18a2-4c4c-a21c-9b31b067d7cb"],
Cell[27598, 673, 426, 8, 48, "Output",ExpressionUUID->"e3d2221c-0c26-470c-822b-f47069f14fc7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28073, 687, 307, 5, 100, "Section",ExpressionUUID->"09fb6f4a-f19c-4c25-a619-2688bd3e9fcd"],
Cell[28383, 694, 1165, 29, 122, "Text",ExpressionUUID->"3068659a-0b31-4bdb-a371-fdf2ebe66acd"],
Cell[CellGroupData[{
Cell[29573, 727, 3068, 89, 328, "Input",ExpressionUUID->"29b4d9e3-fb8e-477f-b547-cd8f85100e1b"],
Cell[32644, 818, 741, 15, 48, "Output",ExpressionUUID->"d77e8741-5397-4a1b-86dd-62930c80d385"],
Cell[33388, 835, 751, 14, 96, "Message",ExpressionUUID->"32a870e1-6173-4864-b6cb-371314ada486"],
Cell[34142, 851, 1195, 23, 85, "Output",ExpressionUUID->"b703c5fd-7955-4b1e-8b15-8b367c881d92"]
}, Open  ]],
Cell[35352, 877, 215, 5, 52, "Text",ExpressionUUID->"321f7364-59ed-4487-a1f1-d12e72a18ea7"],
Cell[CellGroupData[{
Cell[35592, 886, 3338, 95, 340, "Input",ExpressionUUID->"bc175efc-9006-4508-9a11-9fe7ea10ce4b"],
Cell[38933, 983, 673, 13, 96, "Message",ExpressionUUID->"fc56584e-1170-4390-b0c8-ff79134aaa08"],
Cell[39609, 998, 1136, 21, 106, "Output",ExpressionUUID->"3a94d493-5944-4a86-af21-766f19317dd1"],
Cell[40748, 1021, 487, 11, 41, "Message",ExpressionUUID->"4d18eebd-c154-486d-9e4b-bee184a3f312"],
Cell[41238, 1034, 1238, 24, 176, "Output",ExpressionUUID->"134fc811-b8f9-4e93-b0b3-376617dd332a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

