(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65789,       1790]
NotebookOptionsPosition[     59651,       1684]
NotebookOutlinePosition[     60196,       1704]
CellTagsIndexPosition[     60153,       1701]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Linear Elimination", "Title",
 CellChangeTimes->{{3.9398152070839567`*^9, 3.9398152117860727`*^9}, {
  3.9421541444318066`*^9, 3.9421541513390083`*^9}, {3.944393994649187*^9, 
  3.9443940027240753`*^9}, {3.9443979907577295`*^9, 3.944397995195145*^9}, {
  3.950094046607659*^9, 
  3.9500940531910467`*^9}},ExpressionUUID->"8e791b87-b8fe-4d47-a58b-\
235908e2ee0d"],

Cell[TextData[{
 "A set of linear equality constraints  on an n vector ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]],ExpressionUUID->
  "bd2b60f3-cbfa-46e3-8832-3e021ed4d328"],
 " is an underdetermined system of linear equations\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"B", ".", "x"}], "-", "b"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"2e435c77-741b-4f06-bd52-dc5802c38659"],
 "\nwith an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "n"}], TraditionalForm]],ExpressionUUID->
  "8d9de316-ab3d-4a85-8db7-69d2ee63f395"],
 " coefficient matrix B: each row of the matrix is an equation; the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["i", "th"], TraditionalForm]],ExpressionUUID->
  "331fcd89-4c01-49f7-83e4-a09970b1b900"],
 " column of the matrix gives the dependence on the variable ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "i"], TraditionalForm]],ExpressionUUID->
  "056d77d4-4920-40aa-9ac5-8480a3d2926c"],
 ".  We want to work out how to minimize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"0.5", " ", 
     RowBox[{"x", ".", "A", ".", "x"}]}], "+", 
    RowBox[{"g", ".", "x"}]}], TraditionalForm]],ExpressionUUID->
  "403e2064-56a4-46f2-a31f-3f36273d0951"],
 "\nwith the m constraints ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"B", ".", "x"}], "=", "b"}], TraditionalForm]],ExpressionUUID->
  "36e80d90-6ad9-46b4-88f4-6ffb9e6d616d"],
 ".   We want to work out how to do this as stably as possible.  Then we want \
to work out how to do it reasonably stably and reasonably efficiently.  "
}], "Text",
 CellChangeTimes->{{3.95009406820533*^9, 3.9500944375581837`*^9}, {
  3.9500944944948025`*^9, 3.950094572221246*^9}, {3.950098321589733*^9, 
  3.950098324627533*^9}},ExpressionUUID->"0e0b8580-f61b-4132-9db4-\
bc4793cf65b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "12"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"js", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{"Range", "[", "n", "]"}], ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"j", "->", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "js"}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "m"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "B", "]"}]}], "Input",
 CellChangeTimes->{{3.950094581368885*^9, 3.9500951910791206`*^9}, {
   3.9500952424535217`*^9, 3.950095281246687*^9}, 3.950096772917644*^9, {
   3.950200468157546*^9, 3.9502004728498917`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"bbf0600d-2e1a-4bb0-b8aa-8114988a5ca0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0.4243345879951237`", "0.2118080744525277`", 
      "0.23255872014270862`", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9685796396767992`"}], "0", "0", 
      RowBox[{"-", "0.9775433413020846`"}], "0", "0.07394340701823943`"},
     {"0.9685694366053985`", "0", "0", "0", "0.21455194861935034`", "0", 
      "0.6378324525332224`", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 12}, 0, {
     1, {{0, 3, 6, 9}, {{4}, {5}, {6}, {7}, {10}, {12}, {1}, {5}, {7}}}, {
      0.4243345879951237, 0.2118080744525277, 
      0.23255872014270862`, -0.9685796396767992, -0.9775433413020846, 
      0.07394340701823943, 0.9685694366053985, 0.21455194861935034`, 
      0.6378324525332224}}]]]]], "Output",
 CellChangeTimes->{3.950264167396327*^9},
 CellLabel->
  "Out[7]//MatrixForm=",ExpressionUUID->"d2ab576e-4ace-4d92-b817-\
9f7275ba935b"]
}, Open  ]],

Cell[TextData[{
 "We can not just solve for the first ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "28ee9419-221e-4ba4-94f3-8de1cc5b3e4b"],
 " variables!"
}], "Text",
 CellChangeTimes->{{3.950200481899227*^9, 
  3.950200518329236*^9}},ExpressionUUID->"7a6a790d-c326-4a5d-80a2-\
c5b91a64494c"],

Cell[CellGroupData[{

Cell["SVD Technique", "Subsection",
 CellChangeTimes->{{3.950196202951819*^9, 3.9501962091246777`*^9}, {
  3.9501994495172453`*^9, 
  3.950199453904491*^9}},ExpressionUUID->"84ed1f15-35b6-4241-856f-\
9285eeb8f702"],

Cell[TextData[{
 "The SVD factors a matrix as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{"U", ".", "\[CapitalSigma]", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "03836113-f42b-43cb-8679-ad6ba377808f"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", "U"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"f0577e26-b720-430d-a7ae-56a9ecb147c2"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"V", "\[Transpose]"}], ".", "V"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"7196c0f4-8d71-415d-ae8f-50ce0f61396a"],
 " and ",
 Cell[BoxData[
  FormBox["\[CapitalSigma]", TraditionalForm]],ExpressionUUID->
  "3467198a-7514-4304-9644-410c8da45b56"],
 " diagonal with decreasing positive diagonal entries.. All software tools \
let you access two slightly different SVDs: the key words are \
full/thick/uneconomized vs reduced/thin/economized.  We are talking about \
Short-Fat matrices here.  "
}], "Text",
 CellChangeTimes->{{3.95019621243239*^9, 3.9501964052149143`*^9}, {
  3.950196449003302*^9, 3.9501965187687073`*^9}, {3.9501965672464647`*^9, 
  3.950196589563644*^9}, {3.950196637273966*^9, 3.950196660301231*^9}, {
  3.950196751042779*^9, 
  3.950196780386045*^9}},ExpressionUUID->"7f4d96e4-eed5-40bd-9673-\
6f8a0caa2111"],

Cell[CellGroupData[{

Cell["Full", "Subsubsection",
 CellChangeTimes->{{3.9501965923927517`*^9, 
  3.950196599305004*^9}},ExpressionUUID->"6e9b93f1-4342-4b81-8fc6-\
aff23f92c893"],

Cell["\<\
 Mathematica's default is full and offensively-inefficiently stores the \
diagonal matrix as dense!  \
\>", "Text",
 CellChangeTimes->{{3.95019621243239*^9, 3.9501964052149143`*^9}, {
  3.950196449003302*^9, 3.9501965187687073`*^9}, {3.9501965672464647`*^9, 
  3.950196583568554*^9}},ExpressionUUID->"6c904345-4475-4795-9fae-\
34d6d40320ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "B", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"Dimensions", ",", 
     RowBox[{"{", 
      RowBox[{"U", ",", "S", ",", 
       RowBox[{"V", "\[Transpose]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Norm", "[", 
    RowBox[{"B", "-", 
     RowBox[{"U", ".", "S", ".", 
      RowBox[{"V", "\[Transpose]"}]}]}], "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "S", "]"}]}], "Input",
 CellChangeTimes->{{3.950094581368885*^9, 3.9500951910791206`*^9}, {
   3.9500952424535217`*^9, 3.950095281246687*^9}, 3.950096772917644*^9, {
   3.9500970669496803`*^9, 3.950097070566391*^9}, {3.950196421531712*^9, 
   3.95019644233278*^9}, {3.950196536334968*^9, 3.9501965549050217`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"dfa7143a-8f09-4697-8c37-e27e4aa4f247"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "12"}], "}"}]}], "}"}], ",", 
   "4.359368022049472`*^-15"}], "}"}]], "Output",
 CellChangeTimes->{
  3.950097070976407*^9, {3.950196435815933*^9, 3.950196444830373*^9}, {
   3.950196544587284*^9, 3.9501965558540983`*^9}, {3.950264161075869*^9, 
   3.950264172096235*^9}},
 CellLabel->"Out[9]=",ExpressionUUID->"70a10398-8342-4071-a406-70f68c5e580f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.5209936933358328`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.9895059288386667`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.5259818652400453`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 12}, 0., {
     1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {1.5209936933358328`, 
      0.9895059288386667, 0.5259818652400453}}]]]]], "Output",
 CellChangeTimes->{
  3.950097070976407*^9, {3.950196435815933*^9, 3.950196444830373*^9}, {
   3.950196544587284*^9, 3.9501965558540983`*^9}, {3.950264161075869*^9, 
   3.9502641721118555`*^9}},
 CellLabel->
  "Out[10]//MatrixForm=",ExpressionUUID->"c7c2c183-999a-4fcd-8b5f-\
f1dd4f4a10df"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Thin", "Subsubsection",
 CellChangeTimes->{{3.9501965923927517`*^9, 
  3.950196623703484*^9}},ExpressionUUID->"5eed9920-06d9-4840-9aad-\
2fc7d7a62e4d"],

Cell[TextData[{
 " All the zeros in the \[CapitalSigma] or S matrix are unnecessary! The last \
m-n columns in V are all multiplied by these zeros.  SVDs all have an \
optional argument that says how many singular values to keep.  If I keep  the \
height m singular values then the extra zeros vanish, ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1511c2ad-8565-4cdd-8841-e97c6a03cfc9"],
 " does not change, and I still have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{"U", ".", "S", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cc2c3cce-fedd-48b9-a51b-a5f5b4caa22c"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.95019621243239*^9, 3.9501964052149143`*^9}, {
  3.950196449003302*^9, 3.9501965187687073`*^9}, {3.9501965672464647`*^9, 
  3.950196583568554*^9}, {3.950196703749062*^9, 3.950196739719831*^9}, {
  3.950196793314756*^9, 
  3.950196963690733*^9}},ExpressionUUID->"83940c9d-5683-4d8e-819f-\
3b4942cb1325"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", 
    RowBox[{"B", ",", "m"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"Dimensions", ",", 
     RowBox[{"{", 
      RowBox[{"U", ",", "S", ",", 
       RowBox[{"V", "\[Transpose]"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Norm", "[", 
    RowBox[{"B", "-", 
     RowBox[{"U", ".", "S", ".", 
      RowBox[{"V", "\[Transpose]"}]}]}], "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "S", "]"}]}], "Input",
 CellChangeTimes->{{3.950094581368885*^9, 3.9500951910791206`*^9}, {
   3.9500952424535217`*^9, 3.950095281246687*^9}, 3.950096772917644*^9, {
   3.9500970669496803`*^9, 3.950097070566391*^9}, {3.950196421531712*^9, 
   3.95019644233278*^9}, {3.950196536334968*^9, 3.9501965549050217`*^9}, {
   3.950196813259519*^9, 3.950196813580955*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"d53819ae-94f7-455c-bec6-921564da7c0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "12"}], "}"}]}], "}"}], ",", 
   "4.359368022049472`*^-15"}], "}"}]], "Output",
 CellChangeTimes->{3.950196814492632*^9, 3.950264214915208*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"cc9e531d-a7b8-4401-935d-1f18d2634ae9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.5209936933358328`", "0.`", "0.`"},
     {"0.`", "0.9895059288386667`", "0.`"},
     {"0.`", "0.`", "0.5259818652400453`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0., {
     1, {{0, 1, 2, 3}, {{1}, {2}, {3}}}, {1.5209936933358328`, 
      0.9895059288386667, 0.5259818652400453}}]]]]], "Output",
 CellChangeTimes->{3.950196814492632*^9, 3.950264214930831*^9},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"47b27706-feb3-4aab-91c2-\
0e905db64252"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other software tools", "Subsubsection",
 CellChangeTimes->{{3.950196984554686*^9, 
  3.950196989784253*^9}},ExpressionUUID->"aa868dc9-9915-451c-b8e4-\
328dfcb67f17"],

Cell[TextData[{
 "Some software packages give the thin decomposition by default.  You never \
want the extra zeros in S but as we will see we want the vectors (called \
quiet columns) in the bit of ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "365321fa-b112-4107-8838-597169c8e955"],
 " that gets multiplied by those zeros. They are quiet because the get \
multiplied by zeros.  "
}], "Text",
 CellChangeTimes->{{3.9501969937869797`*^9, 
  3.9501971190643063`*^9}},ExpressionUUID->"705eb0c8-04c6-45cb-919e-\
389ac127c950"],

Cell[CellGroupData[{

Cell["Cost", "Subsubsubsection",
 CellChangeTimes->{{3.950196984554686*^9, 3.950196989784253*^9}, {
  3.950197130532197*^9, 
  3.950197131148767*^9}},ExpressionUUID->"217ba0a2-460d-4961-a0e0-\
53548b701f10"],

Cell["\<\
The SVD is one generalization of an eigenvalue decomposition to non-square \
matrices. An SVD is a comparatively expensive operation.   Not every piece of \
hardware has an SVD library! \
\>", "Text",
 CellChangeTimes->{{3.9501969937869797`*^9, 3.9501972239598017`*^9}, {
  3.9501972928750153`*^9, 3.950197322835867*^9}, {3.9501974240159607`*^9, 
  3.950197430052514*^9}, {3.9501976118548813`*^9, 
  3.950197714232139*^9}},ExpressionUUID->"03723ef0-dfb7-47f6-8edc-\
efb9888c1a99"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["What do we want? How do we get it from an SVD.", "Subsubsection",
 CellChangeTimes->{{3.950196984554686*^9, 3.950196989784253*^9}, {
  3.950197130532197*^9, 3.950197131148767*^9}, {3.9501977303377533`*^9, 
  3.9501977506267242`*^9}},ExpressionUUID->"04f1620d-6d29-4d06-aef0-\
fba7ed162147"],

Cell[TextData[{
 "To reduce ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["min", 
      RowBox[{
       RowBox[{
        RowBox[{"B", ".", "x"}], "+", "b"}], "==", "0"}]], " ", "0.5", 
     RowBox[{"x", ".", "A", ".", "x"}]}], "+", 
    RowBox[{"g", ".", "x"}]}], TraditionalForm]],ExpressionUUID->
  "929a0f16-6222-407c-9d91-d621e4404502"],
 " we want to be able to represent all the solutions of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"B", ".", "x"}], "+", "b"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"8b7b3e22-e3f0-4732-abd3-101befa37895"],
 " in a stable and convenient way.  The solutions of this underdetermined \
system are\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{
     SubscriptBox["x", "p"], "+", 
     SubscriptBox["x", "c"]}]}], TraditionalForm]],ExpressionUUID->
  "464adec5-d779-443d-986f-70b13ccc4c42"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "p"], TraditionalForm]],ExpressionUUID->
  "2c2f77b7-343f-4321-9920-545485430229"],
 " satisfies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"B", ".", 
      SubscriptBox["x", "p"]}], "+", "b"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"e592d7fc-0c8b-45cd-bbad-9811ad5aa895"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "c"], TraditionalForm]],ExpressionUUID->
  "3b73bd04-2690-40b2-a828-84f6836124b3"],
 " satisfies ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"B", ".", 
     SubscriptBox["x", "c"]}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "e08736d8-3db8-4803-9bf9-7013846d5b52"],
 ".  What we need is a particular solution and a basis for the null space of ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "e8690afd-75bd-4c91-a7ba-2ea7db5d8f94"],
 ".  "
}], "Text",
 CellChangeTimes->{{3.9501969937869797`*^9, 3.9501972239598017`*^9}, {
  3.9501972928750153`*^9, 3.950197322835867*^9}, {3.9501974240159607`*^9, 
  3.950197430052514*^9}, {3.9501976118548813`*^9, 3.950197714232139*^9}, {
  3.95019775627164*^9, 
  3.950198094115532*^9}},ExpressionUUID->"bec1dd53-f32d-4038-a39c-\
d05d1c47a6c9"],

Cell[TextData[{
 "If ",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{"U", ".", "S", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "5b8392fc-d224-42de-95e3-5f68ba34d48a"],
 " is the full SVD then the quiet columns of ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "1f2db69d-43d0-44f7-a62a-42facb66d86a"],
 " are a basis for the null space of ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "f657f3b9-599f-46b2-89ca-f778324fd063"],
 ". \nIf ",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{"U", ".", "S", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "5d3e29a3-242f-4a9b-b38c-1762099b8c4f"],
 " is the thin SVD then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "p"], "=", 
    RowBox[{"-", 
     RowBox[{"V", ".", 
      SuperscriptBox["S", 
       RowBox[{"-", "1"}]], ".", 
      RowBox[{"U", "\[Transpose]"}], ".", "b"}]}]}], TraditionalForm]],
  ExpressionUUID->"d314d953-b687-4b08-a796-9beaff81cfc3"],
 " is the minimal norm solution of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"B", ".", "x"}], "+", "b"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"96686baa-274c-450d-b6ab-13d4b4cc826b"],
 "."
}], "Text",
 CellChangeTimes->{{3.9501969937869797`*^9, 3.9501972239598017`*^9}, {
  3.9501972928750153`*^9, 3.950197322835867*^9}, {3.9501974240159607`*^9, 
  3.950197430052514*^9}, {3.9501976118548813`*^9, 3.950197714232139*^9}, {
  3.95019775627164*^9, 
  3.950198337236659*^9}},ExpressionUUID->"02846318-49a7-4c8d-b8e4-\
946b8c882eb5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "12"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"js", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"RandomSample", "[", 
          RowBox[{
           RowBox[{"Range", "[", "n", "]"}], ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"j", "->", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "js"}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "m"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"U", ",", "S", ",", "V"}], "}"}], "=", 
   RowBox[{"SingularValueDecomposition", "[", "B", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"V", "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"m", "+", "1"}], ";;", "n"}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"-", 
    RowBox[{"V", ".", 
     RowBox[{"PseudoInverse", "[", "S", "]"}], ".", 
     RowBox[{"U", "\[Transpose]"}], ".", "b"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"n", "-", "m"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"xp", "+", 
    RowBox[{"Q", ".", "y"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"B", ".", "x"}], "+", "b"}], "]"}]}], "Input",
 CellChangeTimes->{{3.950094581368885*^9, 3.9500951910791206`*^9}, {
   3.9500952424535217`*^9, 3.950095281246687*^9}, 3.950096772917644*^9, {
   3.950198402747089*^9, 3.950198640699545*^9}, {3.950198673530129*^9, 
   3.950198792304161*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"4af37929-c20f-409b-847e-20f545b70e05"],

Cell[BoxData["1.5700924586837752`*^-16"], "Output",
 CellChangeTimes->{3.950264353281152*^9, 3.9502645732626734`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"5d9cb3f9-aeea-4632-8ac4-392552195194"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Summary.", "Subsubsection",
 CellChangeTimes->{{3.950196984554686*^9, 3.950196989784253*^9}, {
  3.950197130532197*^9, 3.950197131148767*^9}, {3.9501977303377533`*^9, 
  3.9501977506267242`*^9}, {3.9501988993099213`*^9, 
  3.950198901161149*^9}},ExpressionUUID->"23fcf7c1-d166-4e53-b49c-\
63e7c70a3003"],

Cell[TextData[{
 "We want to minimize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"0.5", " ", 
     RowBox[{"x", ".", "A", ".", "x"}]}], "+", 
    RowBox[{"g", ".", "x"}]}], TraditionalForm]],ExpressionUUID->
  "1a84406c-15fb-48cf-a8fb-074933085427"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"B", ".", "x"}], "+", "b"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"928b5395-5402-4f79-bcc7-c35cc83def79"],
 "\nwe can compute ",
 Cell[BoxData[
  FormBox[
   RowBox[{"B", "=", 
    RowBox[{"U", ".", "S", ".", 
     RowBox[{"V", "\[Transpose]"}]}]}], TraditionalForm]],ExpressionUUID->
  "7e6f7a1a-fbdc-4a6e-83b5-ba42904fefae"],
 " and build ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "p"], "=", 
    RowBox[{"-", 
     RowBox[{"V", ".", 
      SuperscriptBox["S", 
       RowBox[{"-", "1"}]], ".", 
      RowBox[{"U", "\[Transpose]"}], ".", "b"}]}]}], TraditionalForm]],
  ExpressionUUID->"cc29eb00-96fb-4c26-a6af-d69eb3a989a4"],
 "  and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "=", 
    RowBox[{"V", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"m", "+", "1"}], ";;", "n"}]}], "\[RightDoubleBracket]"}]}], 
   TraditionalForm]],ExpressionUUID->"96a8b500-ac17-432a-8981-ab6bdd6e5818"],
 " and instead minimize for\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{
     SubscriptBox["x", "p"], "+", 
     RowBox[{"Q", ".", "y"}]}]}], TraditionalForm]],ExpressionUUID->
  "c7cc294b-8f18-4f37-9da8-9699925d925f"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"n", "-", "m"}]]}], TraditionalForm]],ExpressionUUID->
  "ffd08515-f153-4726-9f6a-3259619e16c8"],
 ". This is a very stable but comparatively expensive process.\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"0.5", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "p"], "+", 
         RowBox[{"Q", ".", "y"}]}], ")"}], ".", "A", ".", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["x", "p"], "+", 
         RowBox[{"Q", ".", "y"}]}], ")"}]}]}], "+", 
     RowBox[{"g", ".", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "p"], "+", 
        RowBox[{"Q", ".", "y"}]}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{"0.5", 
      RowBox[{"y", ".", 
       OverscriptBox["A", "^"], ".", "y"}]}], "+", 
     RowBox[{
      OverscriptBox["g", "^"], ".", "y"}], "+", 
     OverscriptBox["c", "^"]}]}], TraditionalForm]],ExpressionUUID->
  "1a65efb9-9eac-4807-a382-7f6ca6f88ead"],
 "\nwhere \n\t",
 Cell[BoxData[
  FormBox[GridBox[{
     {
      OverscriptBox["A", "^"], "=", 
      RowBox[{
       RowBox[{"Q", "\[Transpose]"}], ".", "A", ".", "Q"}]},
     {
      OverscriptBox["g", "^"], "=", "\[Placeholder]"},
     {
      OverscriptBox["c", "^"], "=", "\[Placeholder]"}
    }], TraditionalForm]],ExpressionUUID->
  "875a61b6-00cd-46a8-ba4e-f7edf4c9d4b0"],
 "\nwork out the expressions for the missing bits as an exercise. "
}], "Text",
 CellChangeTimes->{{3.950198841994157*^9, 3.950198870518745*^9}, {
  3.9501989054209557`*^9, 3.950199096535613*^9}, {3.9501991431094503`*^9, 
  3.950199412799905*^9}, {3.9502186181735888`*^9, 
  3.950218619665937*^9}},ExpressionUUID->"835d6d14-bc76-4893-b221-\
35bdf70ca243"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["QR Technique", "Subsection",
 CellChangeTimes->{{3.950196202951819*^9, 3.9501962091246777`*^9}, {
  3.9501994495172453`*^9, 3.950199453904491*^9}, {3.9501994895051937`*^9, 
  3.9501994900616693`*^9}},ExpressionUUID->"0698335c-3757-49aa-b25f-\
b507bf23365a"],

Cell[TextData[{
 "The QR decomposition factors a Tall Skinny ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "781199d4-4a96-4d0c-a66c-fd0691ac23ab"],
 " matrix ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "9b201b1e-fb9a-45f7-8393-893f4c14d771"],
 " into ",
 Cell[BoxData[
  FormBox[
   RowBox[{"A", "=", 
    RowBox[{"Q", ".", "R"}]}], TraditionalForm]],ExpressionUUID->
  "060e6cba-cc02-4d75-98e9-c5dfcc395961"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "=", "I"}], TraditionalForm]],
  ExpressionUUID->"f4be5df1-aac5-4f15-8453-bce13dc2e942"],
 " and ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "c6c0e9e5-8817-4ca9-9763-a4a42b71f7ce"],
 " upper triangular.  Just like the SVD there is a reduced and non-reduced \
version. In the reduced version ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "b61b7eec-93ee-464c-bebb-303a0547759e"],
 " is the same shape as ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "085b5356-ab65-4c62-b62d-0db455076234"],
 " and ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "90e0c7b9-a87f-4f84-a532-1a715fae0a7b"],
 " is a small ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "93e9494e-4c20-40b6-a99e-1c20dfc19fe7"],
 " upper triangular matrix. In the unreduced version ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]],ExpressionUUID->
  "86edf4b3-9073-4c42-ad8a-57040dc3cc12"],
 " is a big square orthogonal matrix and ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "d1c21673-1f26-46e8-8f5b-daef91c0b9eb"],
 " is an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[Times]", "m"}], TraditionalForm]],ExpressionUUID->
  "ed88419c-4711-4532-86c2-ea3273a29705"],
 " upper triangular matrix with a whole lot of zeros at the bottom.  The last \
",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "-", "m"}], TraditionalForm]],ExpressionUUID->
  "ae659add-1233-4139-9305-8dbe9e516045"],
 " cols of Q span the null space of ",
 Cell[BoxData[
  FormBox["A", TraditionalForm]],ExpressionUUID->
  "9799993b-ba17-41f8-ba9a-e15e97547db8"],
 ".  Mathematica computes the thin QR decomposition. Matlab computes thick QR \
decomposition by default.  Julia returns a compressed storage Q which can \
apply the full Q to any m vector. Mathematica has a NullSpace command that \
returns an orthogonal basis for the nullspace using the compressed format QR \
internally.   To make the QR decomposition safe you need to pivot.   "
}], "Text",
 CellChangeTimes->{{3.9502169980741777`*^9, 3.950217296471706*^9}, {
  3.9502173949108*^9, 3.950217555603829*^9}, {3.950217586853506*^9, 
  3.9502177143137217`*^9}, {3.950217800837199*^9, 3.9502179027590637`*^9}, {
  3.9502180696930017`*^9, 
  3.950218108978252*^9}},ExpressionUUID->"ed55ae9f-5911-4c70-a65c-\
dc7d52e5e36b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{
    RowBox[{"NullSpace", "[", "B", "]"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"B", ",", 
     RowBox[{"-", "b"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"n", "-", "m"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"xp", "+", 
    RowBox[{"Q", ".", "y"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", ".", "xp"}], "+", "b"}]}], "Input",
 CellChangeTimes->{{3.95021746581603*^9, 3.950217472982565*^9}, {
  3.950217718971665*^9, 3.950217795170041*^9}, {3.950217908437293*^9, 
  3.950218011143375*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"2c080bde-3332-4a84-b396-321113c0dda8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Summary and \[OpenCurlyDoubleQuote]Quality\[CloseCurlyDoubleQuote] \
Procedure", "Subsection",
 CellChangeTimes->{{3.950196202951819*^9, 3.9501962091246777`*^9}, {
  3.9501994495172453`*^9, 3.950199453904491*^9}, {3.9501994895051937`*^9, 
  3.9501994900616693`*^9}, {3.9502185724233303`*^9, 3.950218572956739*^9}, {
  3.950218609968357*^9, 3.9502186114345284`*^9}, {3.9514661746571765`*^9, 
  3.951466192019049*^9}},ExpressionUUID->"0f9d9c4d-b583-4032-8ac5-\
73f409204967"],

Cell[TextData[{
 "We want to minimize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"0.5", " ", 
     RowBox[{"x", ".", "A", ".", "x"}]}], "+", 
    RowBox[{"g", ".", "x"}]}], TraditionalForm]],ExpressionUUID->
  "d980e30a-ad51-4c0c-b124-21cf3cf4d7c6"],
 " with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"B", ".", "x"}], "+", "b"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"002e3163-a6aa-46b1-91db-610afa8cd44b"],
 "\nwe compute a representation of all solutions of the constraint\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{
     SubscriptBox["x", "p"], "+", 
     RowBox[{"Q", ".", "y"}]}]}], TraditionalForm]],ExpressionUUID->
  "b0adb4d1-6651-4faf-a3b7-ea3e3fbcdd26"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"n", "-", "m"}]]}], TraditionalForm]],ExpressionUUID->
  "0fcbf324-5e95-472f-9d76-31960b18b2a0"],
 " and minimize\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"0.5", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "p"], "+", 
        RowBox[{"Q", ".", "y"}]}], ")"}], ".", "A", ".", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "p"], "+", 
        RowBox[{"Q", ".", "y"}]}], ")"}]}]}], "+", 
    RowBox[{"g", ".", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["x", "p"], "+", 
       RowBox[{"Q", ".", "y"}]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "bd5c2788-b8c5-4467-b18c-3272f05d9442"],
 "\nover all ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalR]", 
     RowBox[{"n", "-", "m"}]]}], TraditionalForm]],ExpressionUUID->
  "d8153ca4-33df-40cd-9440-16ed95122488"],
 ". It looks like this."
}], "Text",
 CellChangeTimes->{{3.950198841994157*^9, 3.950198870518745*^9}, {
  3.9501989054209557`*^9, 3.950199096535613*^9}, {3.9501991431094503`*^9, 
  3.950199412799905*^9}, {3.9502186181735888`*^9, 3.950218619665937*^9}, {
  3.950218663206707*^9, 3.950218808841034*^9}, {3.950222226662084*^9, 
  3.950222232780984*^9}},ExpressionUUID->"916c96c0-2275-44d1-b4df-\
83f43e8a5b49"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "12"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", ".", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"B", ",", 
     RowBox[{"-", "b"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{
    RowBox[{"NullSpace", "[", "B", "]"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"x", ",", "y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "x_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"0.5", 
    RowBox[{"x", ".", "A", ".", "x"}]}], "+", 
   RowBox[{"g", ".", "x"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr", "[", "y_List", "]"}], ":=", 
  RowBox[{"f", "[", 
   RowBox[{"xp", "+", 
    RowBox[{"Q", ".", "y"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"n", "-", "m"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"fMin", ",", "ySub"}], "}"}], "=", 
  RowBox[{"FindMinimum", "[", 
   RowBox[{
    RowBox[{"fr", "[", "y", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "y0"}], "}"}]}], 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"StepMonitor", ":>", 
      RowBox[{"Print", "[", 
       RowBox[{"fr", "[", "y", "]"}], "]"}]}]}], "*)"}], " ", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yMin", " ", "=", 
   RowBox[{"y", "/.", "ySub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xMin", "=", 
   RowBox[{"xp", "+", 
    RowBox[{"Q", ".", "yMin"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"fr", "[", "yMin", "]"}], ",", 
   RowBox[{"f", "[", "xMin", "]"}], ",", 
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{"B", ".", "xMin"}], "+", "b"}], "]"}]}], 
  "}"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9502188294502497`*^9, 3.9502190677185*^9}, {
  3.950219099144946*^9, 3.950219239202301*^9}, {3.950219289878976*^9, 
  3.9502193075342093`*^9}, {3.9502196420175*^9, 3.950219650894064*^9}, {
  3.9502197240894737`*^9, 3.9502198595765133`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"49b0476c-7b22-4d8e-a3a7-8cc5c260a58c"],

Cell[BoxData[
 TemplateBox[{
  "FindMinimum", "lstol", 
   "\"The line search decreased the step size to within the tolerance \
specified by AccuracyGoal and PrecisionGoal but was unable to find a \
sufficient decrease in the function. You may need more than \\!\\(\\*RowBox[{\
\\\"MachinePrecision\\\"}]\\) digits of working precision to meet these \
tolerances.\"", 2, 63, 2, 22144119223348601765, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9514677854257965`*^9, 3.951467887197171*^9},
 CellLabel->
  "During evaluation of \
In[52]:=",ExpressionUUID->"1a9909a1-1056-4f44-95a8-abe1459f9a2b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.4718476339759465`"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.40211752663428635`"}], ",", 
       RowBox[{"-", "2.0034616516621115`"}], ",", 
       RowBox[{"-", "0.7078576451748392`"}], ",", "1.1032638352969166`", ",", 
       RowBox[{"-", "1.1742318590579248`"}], ",", "0.33256628121857074`", ",", 
       RowBox[{"-", "1.4880029793657843`"}], ",", 
       RowBox[{"-", "1.43890104141421`"}], ",", 
       RowBox[{"-", "0.45977140633778096`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.950219301812049*^9, 3.950219328537509*^9}, 
   3.950219451000319*^9, 3.950219651378044*^9, 3.950219749346945*^9, {
   3.950219812751124*^9, 3.950219860664163*^9}, 3.950264609574262*^9, 
   3.9502646731874275`*^9, 3.9514677854570065`*^9, 3.951467887212824*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"87012eca-bfb2-4a32-93ed-eabed7dd58b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.4718476339759465`"}], ",", 
   RowBox[{"-", "1.4718476339759465`"}], ",", "8.158439733063109`*^-16"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.950219301812049*^9, 3.950219328537509*^9}, 
   3.950219451000319*^9, 3.950219651378044*^9, 3.950219749346945*^9, {
   3.950219812751124*^9, 3.950219860664163*^9}, 3.950264609574262*^9, 
   3.9502646731874275`*^9, 3.9514677854570065`*^9, 3.951467887212824*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"64440a0c-4483-4a7c-a59d-7cb64e224355"]
}, Open  ]],

Cell[TextData[{
 "We check the answer using the KKT equations.  We have already checked we \
satisfy the constraints. The first and main bit of the KKT equations p321 is\n\
\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Del]", "x"], 
     RowBox[{"\[ScriptCapitalL]", "(", 
      RowBox[{"x", ",", "\[Lambda]"}], ")"}]}], "==", "0"}], 
   TraditionalForm]],ExpressionUUID->"fe181655-ca6d-4121-a984-b3730f68026e"],
 "\nwhere (in the language of p321)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalL]", "(", 
     RowBox[{"x", ",", "\[Lambda]"}], ")"}], ":=", 
    RowBox[{
     RowBox[{"f", "(", "x", ")"}], "-", 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "m"], 
      RowBox[{
       SubscriptBox["\[Lambda]", "i"], "(", 
       RowBox[{
        RowBox[{
         RowBox[{"B", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "All"}], "\[RightDoubleBracket]"}], ".", "x"}], 
        "+", 
        SubscriptBox["b", "i"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"450981be-5f48-4e14-888b-0a8db81b94ce"],
 "\nWe can write this without the sum using matrix vector products\n\t ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalL]", "(", 
     RowBox[{"x", ",", "\[Lambda]"}], ")"}], ":=", 
    RowBox[{
     RowBox[{"f", "(", "x", ")"}], "-", 
     RowBox[{"\[Lambda]", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"B", ".", "x"}], "+", "b"}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"c4fd3b6a-d3cd-4242-ac6f-075b7eca2911"],
 "\nso \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Del]", "x"], 
     RowBox[{"\[ScriptCapitalL]", "(", 
      RowBox[{"x", ",", "\[Lambda]"}], ")"}]}], ":=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "x"], 
      RowBox[{"f", "(", "x", ")"}]}], "-", 
     RowBox[{"\[Lambda]", ".", "B"}]}]}], TraditionalForm]],ExpressionUUID->
  "e776b04c-ebbf-4835-b450-d99a44fdedcc"],
 "\nwe have (as always that)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Del]", "x"], "f"}], "=", 
    RowBox[{
     RowBox[{"A", ".", "x"}], "+", "g"}]}], TraditionalForm]],ExpressionUUID->
  "ecd0be0a-308e-4158-8b05-4c26dac0b890"],
 ".\nThe KKT equations say that x is a CP if there a vector of m multipliers \
satisfying\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"A", ".", "x"}], "+", "g", "-", 
     RowBox[{"\[Lambda]", ".", "B"}]}], "==", "0"}], TraditionalForm]],
  ExpressionUUID->"a3900e8f-3951-466c-87a0-67ea0bd9bd1c"],
 "\nWe avoided computing the multipliers by eliminating variables."
}], "Text",
 CellChangeTimes->{{3.9502194780895433`*^9, 3.950219514902135*^9}, {
  3.950219879169191*^9, 3.9502199471417723`*^9}, {3.9502200586572847`*^9, 
  3.950220420796829*^9}, {3.950220482434638*^9, 3.950220654119307*^9}, {
  3.950220818068385*^9, 3.950220962775214*^9}, {3.9502211635683002`*^9, 
  3.9502212171946173`*^9}, {3.951466220828166*^9, 
  3.9514662214634075`*^9}},ExpressionUUID->"cd404b96-90e1-4daa-8a0c-\
75cd6b53fd3b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", ",", "n"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "12"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "m"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"A", "=", 
   RowBox[{"A", ".", 
    RowBox[{"A", "\[Transpose]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"B", ",", 
     RowBox[{"-", "b"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{
    RowBox[{"NullSpace", "[", "B", "]"}], "\[Transpose]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "fr", ",", "x", ",", "y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "x_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"0.5", 
    RowBox[{"x", ".", "A", ".", "x"}]}], "+", 
   RowBox[{"g", ".", "x"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fr", "[", "y_List", "]"}], ":=", 
  RowBox[{"f", "[", 
   RowBox[{"xp", "+", 
    RowBox[{"Q", ".", "y"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"n", "-", "m"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fMin", ",", "ySub"}], "}"}], "=", 
   RowBox[{"FindMinimum", "[", 
    RowBox[{
     RowBox[{"fr", "[", "y", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "y0"}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"StepMonitor", ":>", 
       RowBox[{"Print", "[", 
        RowBox[{"fr", "[", "y", "]"}], "]"}]}]}], "*)"}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yMin", " ", "=", 
   RowBox[{"y", "/.", "ySub"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xMin", "=", 
   RowBox[{"xp", "+", 
    RowBox[{"Q", ".", "yMin"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]Vec", "=", 
  RowBox[{"Array", "[", 
   RowBox[{"\[Lambda]", ",", "m"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxL", "=", 
   RowBox[{
    RowBox[{"A", ".", "xMin"}], "+", "g", "-", 
    RowBox[{"\[Lambda]Vec", ".", "B"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "[", 
  RowBox[{"dxL", ",", 
   RowBox[{"TableHeadings", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.950220656209895*^9, 3.950220768044207*^9}, {
  3.950220971447586*^9, 3.950220996159297*^9}, {3.950221375271468*^9, 
  3.950221391794816*^9}, {3.950222273671885*^9, 3.950222295103507*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"c39db21d-f457-4c38-a7b8-18a2cbc82fbf"],

Cell[BoxData[
 TemplateBox[{
  "FindMinimum", "lstol", 
   "\"The line search decreased the step size to within the tolerance \
specified by AccuracyGoal and PrecisionGoal but was unable to find a \
sufficient decrease in the function. You may need more than \\!\\(\\*RowBox[{\
\\\"MachinePrecision\\\"}]\\) digits of working precision to meet these \
tolerances.\"", 2, 78, 3, 22144119223348601765, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.95022076406885*^9, 3.9502207684956636`*^9}, 
   3.950220965599194*^9, 3.950220996998988*^9, 3.950221223786619*^9, {
   3.9502213815775013`*^9, 3.950221394640429*^9}, 3.950222295945137*^9, 
   3.9502647857928686`*^9, 3.951468205684291*^9},
 CellLabel->
  "During evaluation of \
In[67]:=",ExpressionUUID->"eff692f0-bdc2-4188-a7cc-b3098b4e7a02"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "1", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "2", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "3", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.950221223795664*^9, {3.9502213815888147`*^9, 3.950221394653384*^9}, 
   3.9502222959627333`*^9, 3.950264785821702*^9, 3.9514682057155323`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"9b72629b-8b50-4c61-a6fd-92a85c0d5ead"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"1", 
      RowBox[{"2.354743950934376`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.9893500192526155`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "-", 
       RowBox[{"0.15634547022271672`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "-", 
       RowBox[{"0.23077017758080887`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"2", 
      RowBox[{"2.0398997794800096`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.5806197608698156`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "+", 
       RowBox[{"0.11369415543646699`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "-", 
       RowBox[{"0.9187243743831832`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"3", 
      RowBox[{
       RowBox[{"-", "0.9948176985457005`"}], "-", 
       RowBox[{"0.8988316147643367`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "+", 
       RowBox[{"0.05425327821763348`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "-", 
       RowBox[{"0.38114598103645436`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"4", 
      RowBox[{"2.220747282411652`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.47505330717298255`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "-", 
       RowBox[{"0.7239827488183073`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "+", 
       RowBox[{"0.30641942906333286`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"5", 
      RowBox[{"0.21026194328432113`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3384714936784339`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "+", 
       RowBox[{"0.6929055178213335`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "-", 
       RowBox[{"0.98634594852488`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"6", 
      RowBox[{
       RowBox[{"-", "2.230330868210456`"}], "-", 
       RowBox[{"0.960868683561273`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "-", 
       RowBox[{"0.05293855516696988`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "+", 
       RowBox[{"0.5423589901810497`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"7", 
      RowBox[{"2.4108354330822364`", "\[VeryThinSpace]", "-", 
       RowBox[{"0.5970877896981617`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "-", 
       RowBox[{"0.8460375733369077`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "-", 
       RowBox[{"0.7182028830267861`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"8", 
      RowBox[{"1.3182038089164871`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.3636132975816402`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "-", 
       RowBox[{"0.4059732793502775`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "+", 
       RowBox[{"0.2254011635314277`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"9", 
      RowBox[{"0.011326654814913573`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.6953585015624957`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "+", 
       RowBox[{"0.47914419316475376`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "-", 
       RowBox[{"0.11622230498870367`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"10", 
      RowBox[{"2.0221609097283872`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.8499147691679809`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "-", 
       RowBox[{"0.46384095020954996`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "+", 
       RowBox[{"0.37345995060231507`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"11", 
      RowBox[{
       RowBox[{"-", "3.6008134734905344`"}], "-", 
       RowBox[{"0.687097948239443`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "+", 
       RowBox[{"0.791343558242219`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "+", 
       RowBox[{"0.2526437207440302`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]},
     {"12", 
      RowBox[{
       RowBox[{"-", "0.8968842256710967`"}], "-", 
       RowBox[{"0.6133342874829317`", " ", 
        RowBox[{"\[Lambda]", "[", "1", "]"}]}], "+", 
       RowBox[{"0.016966162485412273`", " ", 
        RowBox[{"\[Lambda]", "[", "2", "]"}]}], "-", 
       RowBox[{"0.08376032278170387`", " ", 
        RowBox[{"\[Lambda]", "[", "3", "]"}]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{
     "Columns" -> {False, {True}, False}, "Rows" -> {{False}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   OutputFormsDump`HeadedColumn],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$, TableHeadings -> Automatic]]]], "Output",
 CellChangeTimes->{
  3.950221223795664*^9, {3.9502213815888147`*^9, 3.950221394653384*^9}, 
   3.9502222959627333`*^9, 3.950264785821702*^9, 3.9514682057155323`*^9},
 CellLabel->
  "Out[83]//TableForm=",ExpressionUUID->"8bf932b3-a5ce-4c1e-9e66-\
4a15f3a4af73"]
}, Open  ]],

Cell["\<\
Note there are more equations than unknowns!  I can use the first three \
equations to solve for the multipliers and substitute. It is pretty clear \
that these are trying to be zero! \
\>", "Text",
 CellChangeTimes->{{3.950221048824704*^9, 3.950221062140442*^9}, {
  3.9502214206214037`*^9, 
  3.950221538170011*^9}},ExpressionUUID->"9e9db34a-dd2d-43b7-9bb0-\
933fbd0dc56b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"LSub", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"dxL", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "==", "0"}], ",", 
      RowBox[{
       RowBox[{"dxL", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "==", "0"}], ",", 
      RowBox[{
       RowBox[{"dxL", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
       "==", "0"}]}], "}"}], ",", "\[Lambda]Vec"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dxL", "/.", "LSub"}]}], "Input",
 CellChangeTimes->{{3.950221005605942*^9, 3.9502210389480753`*^9}, {
   3.950221130671687*^9, 3.95022113328582*^9}, 3.950221246996428*^9, {
   3.9502214347368803`*^9, 3.950221435222584*^9}, {3.950221591065954*^9, 
   3.950221601513455*^9}, {3.950222305664956*^9, 3.950222308817246*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"579ffa12-8d7e-46ff-a3b0-bc73c992c2ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Lambda]", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"-", "1.59880908357588`"}]}], ",", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", "2", "]"}], "\[Rule]", "2.6702780559113695`"}],
     ",", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", "3", "]"}], "\[Rule]", 
     "1.5403908718490311`"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.950220660120613*^9, 3.9502206892720213`*^9}, {
   3.9502207199447107`*^9, 3.9502207685043783`*^9}, 3.950220965609873*^9, 
   3.950220997009334*^9, {3.950221032518021*^9, 3.950221066451153*^9}, 
   3.950221134238267*^9, {3.950221239656513*^9, 3.9502212519045677`*^9}, 
   3.95022140455634*^9, 3.950221436300687*^9, 3.950221504954331*^9, {
   3.9502215966213827`*^9, 3.950221602180892*^9}, 3.9502223095613413`*^9, 
   3.950264820759243*^9, 3.951468298491371*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"62362305-fec6-489b-8a97-50cc34680c4d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2.220446049250313`*^-16", ",", "2.220446049250313`*^-16", ",", 
    RowBox[{"-", "2.220446049250313`*^-16"}], ",", 
    RowBox[{"-", "1.8158208443530555`*^-6"}], ",", "2.7481249567085086`*^-6", 
    ",", 
    RowBox[{"-", "1.1132429607041416`*^-6"}], ",", 
    RowBox[{"-", "3.916764267586359`*^-6"}], ",", 
    RowBox[{"-", "7.849347904986814`*^-8"}], ",", "1.6130904298972126`*^-6", 
    ",", 
    RowBox[{"-", "5.553513210410088`*^-7"}], ",", "2.3869861349723465`*^-6", 
    ",", "9.391669126002089`*^-7"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.950220660120613*^9, 3.9502206892720213`*^9}, {
   3.9502207199447107`*^9, 3.9502207685043783`*^9}, 3.950220965609873*^9, 
   3.950220997009334*^9, {3.950221032518021*^9, 3.950221066451153*^9}, 
   3.950221134238267*^9, {3.950221239656513*^9, 3.9502212519045677`*^9}, 
   3.95022140455634*^9, 3.950221436300687*^9, 3.950221504954331*^9, {
   3.9502215966213827`*^9, 3.950221602180892*^9}, 3.9502223095613413`*^9, 
   3.950264820759243*^9, 3.951468298491371*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"891eca6e-6bb0-4ac5-bb86-0b04f822eaf8"]
}, Open  ]],

Cell[TextData[{
 "It makes more sense to rewrite the equation\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"A", ".", "xMin"}], "+", "g", "-", 
    RowBox[{"\[Lambda]", ".", "B"}]}], TraditionalForm]],ExpressionUUID->
  "00b30a13-179e-4105-aef1-7a0169d53677"],
 "\nas \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"B", "\[Transpose]"}], ".", "\[Lambda]"}], "=", 
    RowBox[{
     RowBox[{"A", ".", "xMin"}], "+", "g"}]}], TraditionalForm]],
  ExpressionUUID->"25e140c9-93ba-45b3-9a83-88faebcb6573"],
 "\nand compute a least squares solution to all the equations."
}], "Text",
 CellChangeTimes->{{3.95022154116818*^9, 3.9502215676532793`*^9}, {
  3.9502216087544537`*^9, 3.950221689364264*^9}, {3.950222316834092*^9, 
  3.950222319835247*^9}},ExpressionUUID->"d749c690-cd51-4857-9d3d-\
5406ed77eb30"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Lambda]Min", "=", 
  RowBox[{"LeastSquares", "[", 
   RowBox[{
    RowBox[{"B", "\[Transpose]"}], ",", 
    RowBox[{
     RowBox[{"A", ".", "xMin"}], "+", "g"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", ".", "xMin"}], "+", "g", "-", 
  RowBox[{"\[Lambda]Min", ".", "B"}]}]}], "Input",
 CellChangeTimes->{{3.950221694864653*^9, 3.9502217142554293`*^9}, {
  3.950221759838707*^9, 3.950221812232923*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"943441e4-1f5a-4415-a6f7-ce67c8d8e05e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.598809687143314`"}], ",", "2.6702747128155147`", ",", 
   "1.540390510452258`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.950221715155785*^9, 3.950221762213851*^9, {3.9502217969904003`*^9, 
   3.950221812840645*^9}, 3.950222338497139*^9, 3.9502648400219965`*^9, 
   3.951468398247584*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"ab273410-e085-48fa-874d-5608dc4d5037"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8.938038753569799`*^-9", ",", 
   RowBox[{"-", "3.9850961464082957`*^-7"}], ",", "4.98876509325008`*^-7", 
   ",", "2.0705718384306238`*^-7", ",", "5.838472643127091`*^-7", ",", 
   RowBox[{"-", "5.523220394376693`*^-7"}], ",", 
   RowBox[{"-", "4.6844061363238154`*^-7"}], ",", "9.777897100882171`*^-7", 
   ",", 
   RowBox[{"-", "3.6642791667595986`*^-7"}], ",", "3.4736533960355587`*^-7", 
   ",", "6.485408565737316`*^-8", ",", "1.2829067175257336`*^-6"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.950221715155785*^9, 3.950221762213851*^9, {3.9502217969904003`*^9, 
   3.950221812840645*^9}, 3.950222338497139*^9, 3.9502648400219965`*^9, 
   3.9514683982631607`*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"033ed837-8c2b-400c-934f-467d33043391"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.9502657095355563`*^9},ExpressionUUID->"576707b9-e984-4ff6-9beb-\
7c17584cd018"],

Cell[TextData[{
 "We might hope that these residuals were smaller but it is not surprising \
because the tolerance in the original FindRoot is about ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["10", 
    RowBox[{"-", "7"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a8883f45-01b8-41c2-8cbc-bea2055c0fc3"],
 ". "
}], "Text",
 CellChangeTimes->{{3.950221819267707*^9, 
  3.950221946053363*^9}},ExpressionUUID->"0a98bf98-e1e8-4d45-a0ab-\
b157f3c0b0b4"]
}, Open  ]]
}, Open  ]],

Cell["", "Title",ExpressionUUID->"1af6980f-66c3-42e3-be37-149a2d0af533"]
},
WindowToolbars->{"EditBar", "MultipurposeBar"},
WindowSize->{1152, 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification->2.,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"00db8406-8028-49e0-9e4b-b56d12a4c6ab"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 368, 6, 194, "Title",ExpressionUUID->"8e791b87-b8fe-4d47-a58b-235908e2ee0d"],
Cell[951, 30, 1820, 47, 346, "Text",ExpressionUUID->"0e0b8580-f61b-4132-9db4-bc4793cf65b3"],
Cell[CellGroupData[{
Cell[2796, 81, 1622, 46, 286, "Input",ExpressionUUID->"bbf0600d-2e1a-4bb0-b8aa-8114988a5ca0"],
Cell[4421, 129, 1335, 31, 155, "Output",ExpressionUUID->"d2ab576e-4ace-4d92-b817-9f7275ba935b"]
}, Open  ]],
Cell[5771, 163, 317, 9, 70, "Text",ExpressionUUID->"7a6a790d-c326-4a5d-80a2-c5b91a64494c"],
Cell[CellGroupData[{
Cell[6113, 176, 214, 4, 107, "Subsection",ExpressionUUID->"84ed1f15-35b6-4241-856f-9285eeb8f702"],
Cell[6330, 182, 1374, 36, 162, "Text",ExpressionUUID->"7f4d96e4-eed5-40bd-9673-6f8a0caa2111"],
Cell[CellGroupData[{
Cell[7729, 222, 157, 3, 89, "Subsubsection",ExpressionUUID->"6e9b93f1-4342-4b81-8fc6-aff23f92c893"],
Cell[7889, 227, 351, 7, 70, "Text",ExpressionUUID->"6c904345-4475-4795-9fae-34d6d40320ff"],
Cell[CellGroupData[{
Cell[8265, 238, 982, 24, 133, "Input",ExpressionUUID->"dfa7143a-8f09-4697-8c37-e27e4aa4f247"],
Cell[9250, 264, 591, 16, 70, "Output",ExpressionUUID->"70a10398-8342-4071-a406-70f68c5e580f"],
Cell[9844, 282, 1229, 30, 155, "Output",ExpressionUUID->"c7c2c183-999a-4fcd-8b5f-f1dd4f4a10df"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11122, 318, 157, 3, 89, "Subsubsection",ExpressionUUID->"5eed9920-06d9-4840-9aad-2fc7d7a62e4d"],
Cell[11282, 323, 1056, 24, 162, "Text",ExpressionUUID->"83940c9d-5683-4d8e-819f-3b4942cb1325"],
Cell[CellGroupData[{
Cell[12363, 351, 1055, 25, 133, "Input",ExpressionUUID->"d53819ae-94f7-455c-bec6-921564da7c0a"],
Cell[13421, 378, 461, 13, 70, "Output",ExpressionUUID->"cc9e531d-a7b8-4401-935d-1f18d2634ae9"],
Cell[13885, 393, 887, 24, 155, "Output",ExpressionUUID->"47b27706-feb3-4aab-91c2-0e905db64252"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14821, 423, 171, 3, 89, "Subsubsection",ExpressionUUID->"aa868dc9-9915-451c-b8e4-328dfcb67f17"],
Cell[14995, 428, 547, 12, 162, "Text",ExpressionUUID->"705eb0c8-04c6-45cb-919e-389ac127c950"],
Cell[CellGroupData[{
Cell[15567, 444, 207, 4, 64, "Subsubsubsection",ExpressionUUID->"217ba0a2-460d-4961-a0e0-53548b701f10"],
Cell[15777, 450, 490, 9, 116, "Text",ExpressionUUID->"03723ef0-dfb7-47f6-8edc-efb9888c1a99"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16316, 465, 296, 4, 89, "Subsubsection",ExpressionUUID->"04f1620d-6d29-4d06-aef0-fba7ed162147"],
Cell[16615, 471, 2152, 65, 257, "Text",ExpressionUUID->"bec1dd53-f32d-4038-a39c-d05d1c47a6c9"],
Cell[18770, 538, 1636, 48, 117, "Text",ExpressionUUID->"02846318-49a7-4c8d-b8e4-946b8c882eb5"],
Cell[CellGroupData[{
Cell[20431, 590, 2678, 81, 476, "Input",ExpressionUUID->"4af37929-c20f-409b-847e-20f545b70e05"],
Cell[23112, 673, 196, 2, 64, "Output",ExpressionUUID->"5d9cb3f9-aeea-4632-8ac4-392552195194"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23357, 681, 309, 5, 89, "Subsubsection",ExpressionUUID->"23fcf7c1-d166-4e53-b49c-63e7c70a3003"],
Cell[23669, 688, 3367, 105, 531, "Text",ExpressionUUID->"835d6d14-bc76-4893-b221-35bdf70ca243"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[27085, 799, 263, 4, 71, "Subsection",ExpressionUUID->"0698335c-3757-49aa-b25f-b507bf23365a"],
Cell[27351, 805, 2987, 79, 438, "Text",ExpressionUUID->"ed55ae9f-5911-4c70-a65c-dc7d52e5e36b"],
Cell[30341, 886, 961, 28, 209, "Input",ExpressionUUID->"2c080bde-3332-4a84-b396-321113c0dda8"]
}, Closed]],
Cell[CellGroupData[{
Cell[31339, 919, 479, 7, 71, "Subsection",ExpressionUUID->"0f9d9c4d-b583-4032-8ac5-73f409204967"],
Cell[31821, 928, 2179, 65, 342, "Text",ExpressionUUID->"916c96c0-2275-44d1-b4df-83f43e8a5b49"],
Cell[CellGroupData[{
Cell[34025, 997, 3400, 108, 666, "Input",ExpressionUUID->"49b0476c-7b22-4d8e-a3a7-8cc5c260a58c"],
Cell[37428, 1107, 621, 12, 164, "Message",ExpressionUUID->"1a9909a1-1056-4f44-95a8-abe1459f9a2b"],
Cell[38052, 1121, 976, 20, 103, "Output",ExpressionUUID->"87012eca-bfb2-4a32-93ed-eabed7dd58b2"],
Cell[39031, 1143, 543, 10, 69, "Output",ExpressionUUID->"64440a0c-4483-4a7c-a59d-7cb64e224355"]
}, Open  ]],
Cell[39589, 1156, 3093, 85, 699, "Text",ExpressionUUID->"cd404b96-90e1-4daa-8a0c-75cd6b53fd3b"],
Cell[CellGroupData[{
Cell[42707, 1245, 3568, 111, 704, "Input",ExpressionUUID->"c39db21d-f457-4c38-a7b8-18a2cbc82fbf"],
Cell[46278, 1358, 816, 15, 164, "Message",ExpressionUUID->"eff692f0-bdc2-4188-a7cc-b3098b4e7a02"],
Cell[47097, 1375, 440, 9, 64, "Output",ExpressionUUID->"9b72629b-8b50-4c61-a6fd-92a85c0d5ead"],
Cell[47540, 1386, 5247, 122, 457, "Output",ExpressionUUID->"8bf932b3-a5ce-4c1e-9e66-4a15f3a4af73"]
}, Open  ]],
Cell[52802, 1511, 385, 8, 159, "Text",ExpressionUUID->"9e9db34a-dd2d-43b7-9bb0-933fbd0dc56b"],
Cell[CellGroupData[{
Cell[53212, 1523, 938, 21, 95, "Input",ExpressionUUID->"579ffa12-8d7e-46ff-a3b0-bc73c992c2ec"],
Cell[54153, 1546, 963, 20, 64, "Output",ExpressionUUID->"62362305-fec6-489b-8a97-50cc34680c4d"],
Cell[55119, 1568, 1154, 20, 151, "Output",ExpressionUUID->"891eca6e-6bb0-4ac5-bb86-0b04f822eaf8"]
}, Open  ]],
Cell[56288, 1591, 835, 22, 249, "Text",ExpressionUUID->"d749c690-cd51-4857-9d3d-5406ed77eb30"],
Cell[CellGroupData[{
Cell[57148, 1617, 526, 12, 95, "Input",ExpressionUUID->"943441e4-1f5a-4415-a6f7-ce67c8d8e05e"],
Cell[57677, 1631, 428, 9, 64, "Output",ExpressionUUID->"ab273410-e085-48fa-874d-5608dc4d5037"],
Cell[58108, 1642, 793, 15, 162, "Output",ExpressionUUID->"033ed837-8c2b-400c-934f-467d33043391"]
}, Open  ]],
Cell[58916, 1660, 149, 3, 95, "Input",ExpressionUUID->"576707b9-e984-4ff6-9beb-7c17584cd018"],
Cell[59068, 1665, 480, 13, 114, "Text",ExpressionUUID->"0a98bf98-e1e8-4d45-a0ab-b157f3c0b0b4"]
}, Open  ]]
}, Open  ]],
Cell[59575, 1682, 72, 0, 194, "Title",ExpressionUUID->"1af6980f-66c3-42e3-be37-149a2d0af533"]
}
]
*)

